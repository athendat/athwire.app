"use strict";(self.webpackChunkath=self.webpackChunkath||[]).push([[985],{94985:(Fe,y,c)=>{c.r(y),c.d(y,{UsersModule:()=>Ie});var f=c(5303),p=c(35357),J=c(2455),l=c(93075),d=c(82722),h=c(77579),x=c(45119),Z=c(95700),q=c(25736),e=c(5e3),v=c(97967),A=c(37495),Q=c(65620),T=c(25245),_=c(69808),b=c(47423),g=c(81125),u=c(67322),I=c(77531),D=c(74107),N=c(90508),E=c(32368);function Y(t,i){1&t&&(e.ynx(0),e.TgZ(1,"a",35),e._uU(2,"Nuevo"),e.qZA(),e.BQk())}function S(t,i){if(1&t&&(e.ynx(0),e.TgZ(1,"a",35),e._uU(2),e.qZA(),e.BQk()),2&t){const o=e.oxw();e.xp6(2),e.AsE("",o.selectedUser.name," ",o.selectedUser.lastname,"")}}function M(t,i){1&t&&(e.ynx(0),e._uU(1," Nuevo "),e.BQk())}function $(t,i){if(1&t&&(e.ynx(0),e._uU(1),e.BQk()),2&t){const o=e.oxw();e.xp6(1),e.AsE(" ",o.selectedUser.name," ",o.selectedUser.lastname," ")}}const R=function(t){return{"cursor-not-allowed":t}};function O(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){return e.CHM(o),e.oxw().createUser()}),e._UZ(1,"mat-icon",37),e.TgZ(2,"span",38),e._uU(3,"Guardar"),e.qZA(),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("ngClass",e.VKq(3,R,o.userForm.invalid))("disabled",o.userForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function B(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){return e.CHM(o),e.oxw().updateUser()}),e._UZ(1,"mat-icon",37),e.TgZ(2,"span",38),e._uU(3,"Actualizar"),e.qZA(),e.qZA()}2&t&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh"))}function z(t,i){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function P(t,i){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Los apellidos son obligatorios. "),e.qZA())}function L(t,i){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," El correo electr\xf3nico es obligatorio. "),e.qZA())}function H(t,i){1&t&&e._UZ(0,"mat-icon",48),2&t&&e.Q6J("svgIcon","mat_solid:visibility")}function j(t,i){1&t&&e._UZ(0,"mat-icon",48),2&t&&e.Q6J("svgIcon","mat_solid:visibility_off")}function V(t,i){1&t&&(e.TgZ(0,"mat-error",49),e._uU(1,' La contrase\xf1a deber\xe1 tener entre 8 y 100 caracteres e incluir may\xfasculas, min\xfasculas n\xfameros y s\xedmbolos como: !" ? $ % ^ &. '),e.qZA())}function W(t,i){1&t&&(e.TgZ(0,"mat-error",49),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function G(t,i){if(1&t&&(e.TgZ(0,"mat-error",49),e._uU(1),e.qZA()),2&t){const o=e.oxw(2);e.xp6(1),e.hij(" ",o.userForm.get("password").getError("password")," ")}}function K(t,i){1&t&&e._UZ(0,"mat-icon",48),2&t&&e.Q6J("svgIcon","mat_solid:visibility")}function X(t,i){1&t&&e._UZ(0,"mat-icon",48),2&t&&e.Q6J("svgIcon","mat_solid:visibility_off")}function ee(t,i){1&t&&(e.TgZ(0,"mat-error",49),e._uU(1,' La contrase\xf1a deber\xe1 tener entre 8 y 100 caracteres e incluir may\xfasculas, min\xfasculas n\xfameros y s\xedmbolos como: !" ? $ % ^ &. '),e.qZA())}function te(t,i){1&t&&(e.TgZ(0,"mat-error",49),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function oe(t,i){if(1&t&&(e.TgZ(0,"mat-error",49),e._uU(1),e.qZA()),2&t){const o=e.oxw(2);e.xp6(1),e.hij(" ",o.userForm.get("password2").getError("password")," ")}}function re(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"mat-expansion-panel"),e.TgZ(1,"mat-expansion-panel-header",21),e.TgZ(2,"mat-panel-title",22),e.TgZ(3,"div",23),e._uU(4," Contrase\xf1a "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(5,"div",40),e.TgZ(6,"div",25),e.TgZ(7,"mat-form-field",26),e.TgZ(8,"mat-label"),e._uU(9,"Contrase\xf1a"),e.qZA(),e._UZ(10,"input",41,42),e.TgZ(12,"button",43),e.NdJ("click",function(){e.CHM(o);const s=e.MAs(11);return s.type="password"===s.type?"text":"password"}),e.YNc(13,H,1,1,"mat-icon",44),e.YNc(14,j,1,1,"mat-icon",44),e.qZA(),e.YNc(15,V,2,0,"mat-error",45),e.YNc(16,W,2,0,"mat-error",45),e.YNc(17,G,2,1,"mat-error",45),e.qZA(),e.qZA(),e.TgZ(18,"div",25),e.TgZ(19,"mat-form-field",26),e.TgZ(20,"mat-label"),e._uU(21,"Confirmar contrase\xf1a"),e.qZA(),e._UZ(22,"input",46,47),e.TgZ(24,"button",43),e.NdJ("click",function(){e.CHM(o);const s=e.MAs(23);return s.type="password"===s.type?"text":"password"}),e.YNc(25,K,1,1,"mat-icon",44),e.YNc(26,X,1,1,"mat-icon",44),e.qZA(),e.YNc(27,ee,2,0,"mat-error",45),e.YNc(28,te,2,0,"mat-error",45),e.YNc(29,oe,2,1,"mat-error",45),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const o=e.MAs(11),r=e.MAs(23),s=e.oxw();e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("formControlName","password"),e.xp6(3),e.Q6J("ngIf","password"===o.type),e.xp6(1),e.Q6J("ngIf","text"===o.type),e.xp6(1),e.Q6J("ngIf",s.userForm.get("password").hasError("pattern")),e.xp6(1),e.Q6J("ngIf",s.userForm.get("password").hasError("required")),e.xp6(1),e.Q6J("ngIf",s.userForm.get("password").hasError("password")),e.xp6(5),e.Q6J("formControlName","password2"),e.xp6(3),e.Q6J("ngIf","password"===r.type),e.xp6(1),e.Q6J("ngIf","text"===r.type),e.xp6(1),e.Q6J("ngIf",s.userForm.get("password2").hasError("pattern")),e.xp6(1),e.Q6J("ngIf",s.userForm.get("password2").hasError("required")),e.xp6(1),e.Q6J("ngIf",s.userForm.get("password2").hasError("password"))}}let ne=(()=>{class t{constructor(o,r,s,n,a,m,ke){this._activatedRoute=o,this._athConfirmationService=r,this._changeDetectorRef=s,this._formBuilder=n,this._router=a,this._usersService=m,this.store=ke,this.dialogMode="view",this.editMode=!1,this.formSubmitted=!1,this.isValid=!1,this.selectedUser=q.SX,this.showAlert=!1,this.userId=null,this._unsubscribeAll=new h.x}ngOnInit(){this.store.select("auth").pipe((0,d.R)(this._unsubscribeAll)).subscribe(o=>{null!==o.user&&(this._user=o.user,this._changeDetectorRef.markForCheck())}),this.userForm=this._formBuilder.group({_id:[null],userId:[this._user._id,[l.kI.required]],active:[!0],name:[null,[l.kI.required]],lastname:[null,[l.kI.required]],email:[null,[l.kI.email,l.kI.required]],account:[null],password:[null,[l.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)]],password2:[null,[l.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)]]},{validators:this.mustMatch("password","password2")}),this.userPasswordForm=this._formBuilder.group({userId:[null,[l.kI.required]],password:[null,[l.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)]],password2:[null,[l.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)]]},{validators:this.mustMatch("password","password2")}),this._activatedRoute.params.pipe((0,d.R)(this._unsubscribeAll)).subscribe(({userId:o})=>{this.userId=o,"new"!==this.userId&&(this.editMode=!0,this._usersService.selectedUser$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(r=>{this.selectedUser=r}),this.userForm.patchValue(this.selectedUser)),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createUser(){let o=this.userForm.getRawValue();o=(0,x.Z)(o,["_id"]),this._athConfirmationService.open({title:"Crear usuario",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{"confirmed"===s&&this._usersService.createUser(o).pipe((0,d.R)(this._unsubscribeAll)).subscribe(n=>{this._athConfirmationService.open({title:"Confirmaci\xf3n",message:`Usuario ${n.name} ${n.lastname} creado correctamente`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._router.navigateByUrl("/users"),this._changeDetectorRef.markForCheck()},n=>{console.warn(n),this._athConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:n.error.title,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}),this._changeDetectorRef.markForCheck()}updateUser(){const o=this.userForm.getRawValue();this._athConfirmationService.open({title:"Actualizar datos del usuario",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._usersService.updateUser(o).subscribe(n=>{this._athConfirmationService.open({title:"Confirmaci\xf3n",message:`Usuario ${n.user.name} ${n.user.lastname} actualizado correctamente`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._router.navigateByUrl("/users"),this._changeDetectorRef.markForCheck()},n=>{console.warn(n),this._athConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:n.error.title,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}),this._changeDetectorRef.markForCheck()}updateUserPassword(){let o=this.userPasswordForm.getRawValue();o=(0,x.Z)(o,"password2"),this._athConfirmationService.open({title:"Actualizar contrase\xf1a",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._usersService.updateUserPassword(o).subscribe(n=>{this._athConfirmationService.open({title:"Confirmaci\xf3n",message:`${n.message}`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()},n=>{console.warn(n),this._athConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:n.error.title,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}),this._changeDetectorRef.markForCheck()}trackByFn(o,r){return r.id||o}mustMatch(o,r){return s=>{const n=s.get(o),a=s.get(r);if(!n||!a||(a.hasError("mustMatch")&&(delete a.errors.mustMatch,a.updateValueAndValidity()),this._isEmptyInputValue(a.value)||n.value===a.value))return null;const m={mustMatch:"Las contrase\xf1a no coinciden"};return a.setErrors(m),m}}_isEmptyInputValue(o){return null==o||0===o.length}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(p.gz),e.Y36(v.C),e.Y36(e.sBO),e.Y36(l.qu),e.Y36(p.F0),e.Y36(A.K),e.Y36(Q.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ath-user-detail"]],decls:66,vars:31,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700","hover:underline",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl","text-mine-900"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 rounded-sm bg-primary-700 hover:shadow-lg","mat-button","",3,"ngClass","disabled","click",4,"ngIf"],["class","ml-4 rounded-sm bg-primary-700 hover:shadow-lg","mat-button","",3,"click",4,"ngIf"],[1,"flex-auto","p-6","bg-mine-200","shadow","sm:p-10","rounded-t-2xl"],[1,"flex","flex-col","flex-auto","min-w-0"],[3,"formGroup","autocomplete"],[1,"w-full"],[3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","gap-6","p-8","mb-6","border-t-2","sm:grid-cols-4"],[1,"sm:col-span-2"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","required","",3,"type","formControlName","placeholder"],["matInput","","required","",3,"type","formControlName"],[3,"formControlName","placeholder"],[3,"value"],[1,"flex","sm:col-span-2"],[1,"flex","flex-col","w-1/4"],[1,"items-start","font-medium"],[3,"formControlName","color"],[1,"ml-1","text-primary-700"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700","hover:shadow-lg",3,"ngClass","disabled","click"],[1,"text-mine-900",3,"svgIcon"],[1,"ml-2","mr-1","text-lg","text-mine-900"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700","hover:shadow-lg",3,"click"],[1,"grid","w-full","gap-6","p-8","mb-6","border-t-2","sm:grid-cols-2","md:grid-cols-4"],["type","password","matInput","","placeholder","Contrase\xf1a","required","",3,"formControlName"],["passwordField1",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["class","pb-5",4,"ngIf"],["type","password","matInput","","placeholder","Repita la contrase\xf1a","required","",3,"formControlName"],["passwordField2",""],[1,"icon-size-5",3,"svgIcon"],[1,"pb-5"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"a",5),e._uU(7,"Usuarios"),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.YNc(10,Y,3,0,"ng-container",7),e.YNc(11,S,3,2,"ng-container",7),e.qZA(),e.qZA(),e.TgZ(12,"div",8),e.TgZ(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",11),e.TgZ(18,"div",12),e.YNc(19,M,2,0,"ng-container",7),e.YNc(20,$,2,2,"ng-container",7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",13),e.YNc(22,O,4,5,"button",14),e.YNc(23,B,4,1,"button",15),e.qZA(),e.qZA(),e.TgZ(24,"div",16),e.TgZ(25,"div",17),e.TgZ(26,"form",18),e.TgZ(27,"mat-accordion",19),e.TgZ(28,"mat-expansion-panel",20),e.TgZ(29,"mat-expansion-panel-header",21),e.TgZ(30,"mat-panel-title",22),e.TgZ(31,"div",23),e._uU(32," Informaci\xf3n General "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(33,"div",24),e.TgZ(34,"div",25),e.TgZ(35,"mat-form-field",26),e.TgZ(36,"mat-label"),e._uU(37,"Nombre"),e.qZA(),e._UZ(38,"input",27),e.YNc(39,z,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(40,"div",25),e.TgZ(41,"mat-form-field",26),e.TgZ(42,"mat-label"),e._uU(43,"Apellidos"),e.qZA(),e._UZ(44,"input",28),e.YNc(45,P,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(46,"div",25),e.TgZ(47,"mat-form-field",26),e.TgZ(48,"mat-label"),e._uU(49,"Correo electr\xf3nico"),e.qZA(),e._UZ(50,"input",27),e.YNc(51,L,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(52,"div",25),e.TgZ(53,"mat-form-field",26),e.TgZ(54,"mat-label"),e._uU(55,"Asignar cuenta"),e.qZA(),e.TgZ(56,"mat-select",29),e.TgZ(57,"mat-option",30),e._uU(58," Ninguna "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(59,"div",31),e.TgZ(60,"div",32),e.TgZ(61,"span",33),e._uU(62,"Estado"),e.qZA(),e.TgZ(63,"mat-slide-toggle",34),e._uU(64),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(65,re,30,13,"mat-expansion-panel",7),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(6),e.Q6J("routerLink","/users"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("ngIf","new"===r.userId),e.xp6(1),e.Q6J("ngIf","new"!==r.userId),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(5),e.Q6J("ngIf","new"===r.userId),e.xp6(1),e.Q6J("ngIf","new"!==r.userId),e.xp6(2),e.Q6J("ngIf","new"===r.userId),e.xp6(1),e.Q6J("ngIf","new"!==r.userId),e.xp6(3),e.Q6J("formGroup",r.userForm)("autocomplete","off"),e.xp6(2),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre"),e.xp6(1),e.Q6J("ngIf",r.userForm.get("name").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastname"),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname").hasError("required")),e.xp6(5),e.Q6J("type","email")("formControlName","email")("placeholder","Correo electr\xf3nico"),e.xp6(1),e.Q6J("ngIf",r.userForm.get("email").hasError("required")),e.xp6(5),e.Q6J("formControlName","account")("placeholder","Seleccione la cuenta a asignar"),e.xp6(7),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===r.userForm.get("active").value?"Activo":"Inactivo"," "),e.xp6(1),e.Q6J("ngIf",!r.editMode))},directives:[f.PQ,p.yS,T.Hw,_.O5,b.lW,_.mk,l._Y,l.JL,l.sg,g.pp,g.ib,g.yz,g.yK,u.KE,u.hX,I.Nt,l.Fj,l.Q7,l.JJ,l.u,u.TO,D.gD,N.ey,E.Rr,u.R9],encapsulation:2,data:{animation:Z.p},changeDetection:0}),t})();var se=c(86087),U=c(84847),w=c(48966),k=c(87238);function ie(t,i){1&t&&e._UZ(0,"mat-icon",26),2&t&&e.Q6J("svgIcon","mat_solid:visibility")}function ae(t,i){1&t&&e._UZ(0,"mat-icon",26),2&t&&e.Q6J("svgIcon","mat_solid:visibility_off")}function ce(t,i){1&t&&(e.TgZ(0,"mat-error",27),e._uU(1,' La contrase\xf1a deber\xe1 tener entre 8 y 100 caracteres e incluir may\xfasculas, min\xfasculas n\xfameros y s\xedmbolos como: !" ? $ % ^ &. '),e.qZA())}function le(t,i){1&t&&(e.TgZ(0,"mat-error",27),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function me(t,i){if(1&t&&(e.TgZ(0,"mat-error",27),e._uU(1),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.hij(" ",o.userPasswordForm.get("password").getError("password")," ")}}function ue(t,i){1&t&&e._UZ(0,"mat-icon",26),2&t&&e.Q6J("svgIcon","mat_solid:visibility")}function pe(t,i){1&t&&e._UZ(0,"mat-icon",26),2&t&&e.Q6J("svgIcon","mat_solid:visibility_off")}function de(t,i){1&t&&(e.TgZ(0,"mat-error",27),e._uU(1,' La contrase\xf1a deber\xe1 tener entre 8 y 100 caracteres e incluir may\xfasculas, min\xfasculas n\xfameros y s\xedmbolos como: !" ? $ % ^ &. '),e.qZA())}function _e(t,i){1&t&&(e.TgZ(0,"mat-error",27),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function ge(t,i){if(1&t&&(e.TgZ(0,"mat-error",27),e._uU(1),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.hij(" ",o.userPasswordForm.get("password2").getError("password")," ")}}let fe=(()=>{class t{constructor(o,r,s,n,a,m){this.data=o,this._dialogRef=r,this._changeDetectorRef=s,this._formBuilder=n,this._athConfirmationService=a,this._userService=m,this._unsubscribeAll=new h.x,this.selectedUser=o.user}ngOnInit(){this.userPasswordForm=this._formBuilder.group({userId:[this.selectedUser._id,[l.kI.required]],password:[null,[l.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)]],password2:[null,[l.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)]]},{validators:this.mustMatch("password","password2")})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}updateUserPassword(){let o=this.userPasswordForm.getRawValue();o=(0,x.Z)(o,"password2"),this._athConfirmationService.open({title:"Actualizar contrase\xf1a",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._userService.updateUserPassword(o).subscribe(n=>{console.log(n),this._athConfirmationService.open({title:"Confirmaci\xf3n",message:`${n.message}`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this.closeDialog(),this._changeDetectorRef.markForCheck()},n=>{console.warn(n),this._athConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:n.error.title,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}),this._changeDetectorRef.markForCheck()}trackByFn(o,r){return r.id||o}mustMatch(o,r){return s=>{const n=s.get(o),a=s.get(r);if(!n||!a||(a.hasError("mustMatch")&&(delete a.errors.mustMatch,a.updateValueAndValidity()),this._isEmptyInputValue(a.value)||n.value===a.value))return null;const m={mustMatch:"Las contrase\xf1a no coinciden"};return a.setErrors(m),m}}_isEmptyInputValue(o){return null==o||0===o.length}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(w.WI),e.Y36(w.so),e.Y36(e.sBO),e.Y36(l.qu),e.Y36(v.C),e.Y36(A.K))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ath-user-dialog"]],decls:46,vars:22,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-6","pt-1"],[1,"w-full"],[1,"flex","w-full"],[1,"flex","flex-col","justify-end","w-4/5","my-2"],[1,"text-2xl","font-bold","truncate","sm:text-2xl"],[1,"flex","text-xl","font-normal","text-red-900","truncate","cursor-pointer","hover:underline"],[1,"mr-2.5",3,"svgIcon"],["target","_blank",3,"href"],[1,"flex","flex-col","border-t","gap-y-5"],[1,"flex","flex-col","w-full","gap-8","md:flex-row"],[1,"flex","flex-col","w-full","space-y-4"],[1,"flex","flex-col",3,"formGroup","autocomplete"],[1,"flex","flex-col","w-full","gap-4","mt-5","mb-2"],[1,"w-full","fuse-mat-no-subscript"],["type","password","matInput","","placeholder","Contrase\xf1a","required","",3,"formControlName"],["passwordUpdateField1",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["class","pb-5",4,"ngIf"],["type","password","matInput","","placeholder","Repita la contrase\xf1a","required","",3,"formControlName"],["passwordUpdateField2",""],[1,"flex","items-center","justify-between","w-full","px-8","py-4","border-t","sm:px-12","bg-gray-50","dark:bg-transparent"],["mat-button","",1,"rounded-sm",3,"matTooltip","click"],["mat-button","",1,"rounded-sm","text-mine-900","bg-primary-700",3,"disabled","matTooltip","click"],[1,"icon-size-5",3,"svgIcon"],[1,"pb-5"]],template:function(o,r){if(1&o){const s=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"span",6),e._uU(7),e.qZA(),e.TgZ(8,"span",7),e._UZ(9,"mat-icon",8),e.TgZ(10,"a",9),e._uU(11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",10),e.TgZ(13,"div",11),e.TgZ(14,"div",12),e.TgZ(15,"form",13),e.TgZ(16,"div",14),e.TgZ(17,"div",3),e.TgZ(18,"mat-form-field",15),e.TgZ(19,"mat-label"),e._uU(20,"Contrase\xf1a"),e.qZA(),e._UZ(21,"input",16,17),e.TgZ(23,"button",18),e.NdJ("click",function(){e.CHM(s);const a=e.MAs(22);return a.type="password"===a.type?"text":"password"}),e.YNc(24,ie,1,1,"mat-icon",19),e.YNc(25,ae,1,1,"mat-icon",19),e.qZA(),e.YNc(26,ce,2,0,"mat-error",20),e.YNc(27,le,2,0,"mat-error",20),e.YNc(28,me,2,1,"mat-error",20),e.qZA(),e.qZA(),e.TgZ(29,"div",3),e.TgZ(30,"mat-form-field",15),e.TgZ(31,"mat-label"),e._uU(32,"Confirmar contrase\xf1a"),e.qZA(),e._UZ(33,"input",21,22),e.TgZ(35,"button",18),e.NdJ("click",function(){e.CHM(s);const a=e.MAs(34);return a.type="password"===a.type?"text":"password"}),e.YNc(36,ue,1,1,"mat-icon",19),e.YNc(37,pe,1,1,"mat-icon",19),e.qZA(),e.YNc(38,de,2,0,"mat-error",20),e.YNc(39,_e,2,0,"mat-error",20),e.YNc(40,ge,2,1,"mat-error",20),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(41,"div",23),e.TgZ(42,"button",24),e.NdJ("click",function(){return r.closeDialog()}),e._uU(43," Cancelar "),e.qZA(),e.TgZ(44,"button",25),e.NdJ("click",function(){return r.updateUserPassword()}),e._uU(45," Actualizar contrase\xf1a "),e.qZA(),e.qZA(),e.qZA()}if(2&o){const s=e.MAs(22),n=e.MAs(34);e.xp6(7),e.AsE(" ",r.selectedUser.name," ",r.selectedUser.lastname," "),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:mail"),e.xp6(1),e.Q6J("href","mailto:"+r.selectedUser.email,e.LSH),e.xp6(1),e.Oqu(r.selectedUser.email),e.xp6(4),e.Q6J("formGroup",r.userPasswordForm)("autocomplete","off"),e.xp6(6),e.Q6J("formControlName","password"),e.xp6(3),e.Q6J("ngIf","password"===s.type),e.xp6(1),e.Q6J("ngIf","text"===s.type),e.xp6(1),e.Q6J("ngIf",r.userPasswordForm.get("password").hasError("pattern")),e.xp6(1),e.Q6J("ngIf",r.userPasswordForm.get("password").hasError("required")),e.xp6(1),e.Q6J("ngIf",r.userPasswordForm.get("password").hasError("password")),e.xp6(5),e.Q6J("formControlName","password2"),e.xp6(3),e.Q6J("ngIf","password"===n.type),e.xp6(1),e.Q6J("ngIf","text"===n.type),e.xp6(1),e.Q6J("ngIf",r.userPasswordForm.get("password2").hasError("pattern")),e.xp6(1),e.Q6J("ngIf",r.userPasswordForm.get("password2").hasError("required")),e.xp6(1),e.Q6J("ngIf",r.userPasswordForm.get("password2").hasError("password")),e.xp6(2),e.Q6J("matTooltip","Cancelar"),e.xp6(2),e.Q6J("disabled",r.userPasswordForm.invalid)("matTooltip","Actualizar")}},directives:[T.Hw,l._Y,l.JL,l.sg,u.KE,u.hX,I.Nt,l.Fj,l.Q7,l.JJ,l.u,b.lW,u.R9,_.O5,u.TO,k.gM],encapsulation:2,data:{animation:Z.p},changeDetection:0}),t})();var he=c(51927),C=c(92181);function xe(t,i){if(1&t&&(e.TgZ(0,"div",42),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit,r=e.oxw(4);e.xp6(1),e.hij(" ",r.getAccountName(o._id)," ")}}function Ze(t,i){1&t&&(e.TgZ(0,"div",43),e._uU(1," No posee ninguna cuenta asociada "),e.qZA())}function ve(t,i){1&t&&(e.ynx(0),e._UZ(1,"mat-icon",44),e.BQk()),2&t&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Ae(t,i){1&t&&(e.ynx(0),e._UZ(1,"mat-icon",45),e.BQk()),2&t&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Te(t,i){if(1&t){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",34),e.TgZ(2,"div",35),e._uU(3),e.qZA(),e.TgZ(4,"div",30),e._uU(5),e.qZA(),e.YNc(6,xe,2,1,"div",36),e.YNc(7,Ze,2,0,"div",37),e.TgZ(8,"div",31),e.YNc(9,ve,2,1,"ng-container",17),e.YNc(10,Ae,2,1,"ng-container",17),e.qZA(),e.TgZ(11,"div",38),e.TgZ(12,"button",39),e.NdJ("click",function(){const n=e.CHM(o).$implicit;return e.oxw(4).createOrEditUser(n._id)}),e._UZ(13,"mat-icon",24),e.qZA(),e.TgZ(14,"button",40),e.NdJ("click",function(){const n=e.CHM(o).$implicit;return e.oxw(4).openDialog(n,"editPass","720px")}),e._UZ(15,"mat-icon",24),e.qZA(),e.TgZ(16,"button",41),e.NdJ("click",function(){const n=e.CHM(o).$implicit;return e.oxw(4).deleteUser(n)}),e._UZ(17,"mat-icon",24),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&t){const o=i.$implicit;e.xp6(3),e.AsE(" ",o.name," ",o.lastname," "),e.xp6(2),e.hij(" ",o.email," "),e.xp6(1),e.Q6J("ngIf",null!==o._id),e.xp6(1),e.Q6J("ngIf",null===o._id),e.xp6(2),e.Q6J("ngIf",o.active),e.xp6(1),e.Q6J("ngIf",!o.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:key"),e.xp6(1),e.Q6J("disabled","adminwire@gmail.com"===o.email),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function be(t,i){if(1&t&&(e.ynx(0),e.YNc(1,Te,18,11,"ng-container",33),e.BQk()),2&t){const o=i.ngIf,r=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",o)("ngForTrackBy",r.trackByFn)}}function Ue(t,i){if(1&t){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",20),e.TgZ(2,"div",21),e._uU(3,"Listado de usuarios"),e.qZA(),e.TgZ(4,"div",22),e.TgZ(5,"button",23),e._UZ(6,"mat-icon",24),e.qZA(),e.TgZ(7,"mat-menu",null,25),e.TgZ(9,"button",26),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).exportAsExcelFile()}),e._uU(10,"Exportar a excel"),e.qZA(),e.TgZ(11,"button",26),e.NdJ("click",function(){return e.CHM(o),e.oxw(2).exportAsCsvFile()}),e._uU(12,"Exportar a csv"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",27),e.TgZ(14,"div",28),e.TgZ(15,"div",29),e._uU(16," Nombre y Apellidos "),e.qZA(),e.TgZ(17,"div",30),e._uU(18," Correo electr\xf3nico "),e.qZA(),e.TgZ(19,"div",31),e._uU(20," Cuenta "),e.qZA(),e.TgZ(21,"div",31),e._uU(22," Activo "),e.qZA(),e.TgZ(23,"div",32),e._uU(24," Acciones "),e.qZA(),e.qZA(),e.YNc(25,be,2,2,"ng-container",17),e.ALo(26,"async"),e.qZA(),e.BQk()}if(2&t){const o=e.MAs(8),r=e.oxw(2);e.xp6(5),e.Q6J("matMenuTriggerFor",o),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:dots-vertical"),e.xp6(9),e.Q6J("mat-sort-header","name"),e.xp6(10),e.Q6J("ngIf",e.lcZ(26,4,r.users$))}}function we(t,i){if(1&t&&(e.ynx(0),e.YNc(1,Ue,27,6,"ng-container",19),e.BQk()),2&t){const o=i.ngIf;e.oxw();const r=e.MAs(26);e.xp6(1),e.Q6J("ngIf",o)("ngIfElse",r)}}function Ce(t,i){1&t&&(e.TgZ(0,"div",46),e._uU(1,"A\xfan no hay usuarios para esta aplicaci\xf3n!"),e.qZA())}let ye=(()=>{class t{constructor(o,r,s,n,a,m){this._changeDetectorRef=o,this._athConfirmationService=r,this._fileSaverService=s,this._router=n,this._userDialog=a,this._userService=m,this.emptyUser=q.SX,this.searchInputControl=new l.NI,this.selectedUser=null,this.users=[],this._unsubscribeAll=new h.x}ngOnInit(){this.users$=this._userService.users$,this._userService.users$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(o=>{this.users=o,this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createOrEditUser(o="new"){console.log(o),this._router.navigateByUrl(`/users/${o}`)}deleteUser(o){this._athConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar el usuario ${o.name} ${o.lastname}?`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._userService.deleteUser(o._id).subscribe(n=>{!n||(this._athConfirmationService.open({title:"Confirmaci\xf3n",message:`Usuario ${o.name} ${o.lastname} eliminado correctamente`,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck())},n=>{console.log(n),this._athConfirmationService.open({title:`${n.statusText}: ${n.status}`,message:n.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})})}),this._changeDetectorRef.markForCheck()}exportAsExcelFile(){this._fileSaverService.exportAsExcelFile(this.users,"users")}exportAsCsvFile(){this._fileSaverService.exportAsCsvFile(this.users,"users")}trackByFn(o,r){return r.id||o}getAccountName(o){}openDialog(o,r,s){this._userDialog.open(fe,{data:{user:o,dialogMode:r},width:s,panelClass:"ath-dialog-panel"})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(e.sBO),e.Y36(v.C),e.Y36(he.m),e.Y36(p.F0),e.Y36(w.uw),e.Y36(A.K))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ath-users"]],viewQuery:function(o,r){if(1&o&&(e.Gf(se.NW,5),e.Gf(U.YE,5)),2&o){let s;e.iGM(s=e.CRH())&&(r._paginator=s.first),e.iGM(s=e.CRH())&&(r._sort=s.first)}},decls:27,vars:6,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","pb-22","sm:pt-12","sm:pb-28","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700",3,"click"],[1,"text-mine-900",3,"svgIcon"],[1,"ml-2","mr-1","text-lg","text-mine-900"],[1,"flex-auto","p-6","-mt-16","bg-mine-200","shadow","sm:p-10","rounded-t-2xl"],[1,"w-full","p-16","shadow","rounded-2xl","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[4,"ngIf"],["noUsers",""],[4,"ngIf","ngIfElse"],[1,"flex","items-center","justify-between","mb-5"],[1,"text-2xl","font-semibold","leading-tight"],[1,"-mr-3"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["listUsersMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","users-grid","md:px-8","text-md","text-secondary","bg-mine-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"hidden","truncate","md:block"],[1,"hidden","text-center","lg:block"],[1,"text-center"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","users-grid","md:px-8"],[1,"truncate"],["class","hidden lg:block",4,"ngIf"],["class","hidden md:block",4,"ngIf"],[1,"flex","flex-col","justify-center","gap-1","sm:flex-row"],["mat-stroked-button","","matTooltip","Editar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Cambiar contrase\xf1a",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Eliminar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],[1,"hidden","lg:block"],[1,"hidden","md:block"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e.TgZ(5,"div"),e.TgZ(6,"a",4),e._uU(7,"Usuarios"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",5),e.TgZ(9,"a",6),e._UZ(10,"mat-icon",7),e.TgZ(11,"span",8),e._uU(12,"Regresar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",9),e.TgZ(14,"h2",10),e._uU(15," Listado de usuarios "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",11),e.TgZ(17,"button",12),e.NdJ("click",function(){return r.createOrEditUser()}),e._UZ(18,"mat-icon",13),e.TgZ(19,"span",14),e._uU(20,"Nuevo"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",15),e.TgZ(22,"div",16),e.YNc(23,we,2,2,"ng-container",17),e.ALo(24,"async"),e.YNc(25,Ce,2,0,"ng-template",null,18,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(9),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(24,4,r.users$)))},directives:[f.PQ,p.yS,T.Hw,b.lW,_.O5,C.p6,C.VK,C.OP,U.YE,U.nU,_.sg,k.gM],pipes:[_.Ov],encapsulation:2,data:{animation:Z.p},changeDetection:0}),t})();var F=c(15497);const qe=[{path:"",component:ye,resolve:{users:F.o}},{path:":userId",component:ne,resolve:{user:F.O}}];let Ie=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[f.ZD,p.Bz.forChild(qe),J.m]]}),t})()}}]);