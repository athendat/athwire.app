"use strict";(self.webpackChunkath=self.webpackChunkath||[]).push([[225],{5736:(b,Z,n)=>{n.d(Z,{AR:()=>d,pT:()=>v,$w:()=>a,SX:()=>x});const d={_id:null,userId:null,active:!0,owner:null,currency:null,name:null,balance:0,createdAt:null,updatedAt:null},v={_id:null,userId:null,createdAt:null,accountId:null,transactionId:null,invoiceNo:0,amount:0,fincimexTax:0,sendfincimex:!1,remitter:void 0,beneficiary:void 0},a={_id:null,accountId:null,userId:null,reference:null,date:null,valueDate:null,description:null,origin:null,destiny:null,accountOrigin:null,accountDestiny:null,operationType:null,currency:null,initBalance:null,amount:null,endBalance:null},x={_id:null,active:!0,name:null,lastname:null,email:null,password:null,roles:[null]}},7681:(b,Z,n)=>{n.d(Z,{$c:()=>x,EW:()=>p,$G:()=>s});var d=n(7078),v=n(5e3),a=n(5620);let x=(()=>{class c{constructor(m){this.store=m}resolve(m,A){return this.store.dispatch((0,d.vP)())}}return c.\u0275fac=function(m){return new(m||c)(v.LFG(a.yh))},c.\u0275prov=v.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),p=(()=>{class c{constructor(m){this.store=m}resolve(m,A){const f=m.params.accountId;if("new"!==f)return this.store.dispatch((0,d.Mx)({accountId:f}))}}return c.\u0275fac=function(m){return new(m||c)(v.LFG(a.yh))},c.\u0275prov=v.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})(),s=(()=>{class c{constructor(m){this.store=m}resolve(m,A){const f=m.params.accountId;if("new"!==f)return this.store.dispatch((0,d.vg)({accountId:f}))}}return c.\u0275fac=function(m){return new(m||c)(v.LFG(a.yh))},c.\u0275prov=v.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},6596:(b,Z,n)=>{n.d(Z,{bk:()=>a,L3:()=>x,Cj:()=>p});var d=n(5620);const v=s=>s.account,a=(0,d.P1)(v,s=>s.account),x=(0,d.P1)(v,s=>s.accounts),p=(0,d.P1)(v,s=>s.operations)},8225:(b,Z,n)=>{n.r(Z),n.d(Z,{InvoicesModule:()=>ke});var d=n(5357),v=n(2455),a=n(3075),x=n(6087),p=n(4847),s=n(7579),c=n(2722),u=n(5620);const m=o=>o.invoice,A=(0,u.P1)(m,o=>o.invoice),f=(0,u.P1)(m,o=>o.invoices);var q=n(5700),T=n(5736),I=n(345),e=n(5e3),U=n(7967),L=n(1927),J=n(5303),Q=n(5245),k=n(7423),C=n(2181),h=n(9808),M=n(7238);function j(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",34),e.TgZ(2,"div",35),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",36),e._uU(7),e.qZA(),e.TgZ(8,"div",36),e._uU(9),e.qZA(),e.TgZ(10,"div",36),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"div",36),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"div",36),e._uU(17," Test "),e.qZA(),e.TgZ(18,"div",36),e._uU(19),e.ALo(20,"date"),e.qZA(),e.TgZ(21,"div",36),e._uU(22),e.qZA(),e.TgZ(23,"div",36),e._uU(24),e.qZA(),e.TgZ(25,"div",37),e.TgZ(26,"button",38),e.NdJ("click",function(){const g=e.CHM(t).$implicit;return e.oxw(4).editInvoice(g._id)}),e._UZ(27,"mat-icon",21),e.qZA(),e.TgZ(28,"button",39),e.NdJ("click",function(){const g=e.CHM(t).$implicit;return e.oxw(4).deleteInvoice(g._id)}),e._UZ(29,"mat-icon",21),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(3),e.hij(" ",t.invoiceNo," "),e.xp6(2),e.lnq(" ",t.remitter.senderName," ",t.remitter.lastName1," ",t.remitter.lastName2," "),e.xp6(2),e.lnq(" ",t.beneficiary.name," ",t.beneficiary.lastName1," ",t.beneficiary.lastName2," "),e.xp6(2),e.hij(" ",t.beneficiary.cardNo," "),e.xp6(2),e.hij(" ",e.xi3(12,15,t.amount,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(15,18,t.fincimexTax,"1.2-2")," "),e.xp6(5),e.hij(" ",e.xi3(20,21,t.createdAt,"short")," "),e.xp6(3),e.hij(" ",t.accountId.name," "),e.xp6(2),e.hij(" ",t.transactionId," "),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function P(o,r){if(1&o&&(e.ynx(0),e.YNc(1,j,30,24,"ng-container",33),e.BQk()),2&o){const t=r.ngIf,i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}function $(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",27),e.TgZ(2,"div",28),e.TgZ(3,"div",29),e._uU(4," No.Factura "),e.qZA(),e.TgZ(5,"div",30),e._uU(6," Remesante "),e.qZA(),e.TgZ(7,"div",30),e._uU(8," Beneficiario "),e.qZA(),e.TgZ(9,"div",31),e._uU(10," Tarjeta "),e.qZA(),e.TgZ(11,"div",31),e._uU(12," Importe "),e.qZA(),e.TgZ(13,"div",31),e._uU(14," TAX Fincimex "),e.qZA(),e.TgZ(15,"div",31),e._uU(16," Estado "),e.qZA(),e.TgZ(17,"div",31),e._uU(18," Fecha y Hora "),e.qZA(),e.TgZ(19,"div",31),e._uU(20," Cuenta "),e.qZA(),e.TgZ(21,"div",31),e._uU(22," ID Transacci\xf3n "),e.qZA(),e.TgZ(23,"div",32),e._uU(24," Acciones "),e.qZA(),e.qZA(),e.YNc(25,P,2,2,"ng-container",24),e.ALo(26,"async"),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(25),e.Q6J("ngIf",e.lcZ(26,1,t.invoices$))}}function V(o,r){if(1&o&&(e.ynx(0),e.YNc(1,$,27,3,"ng-container",26),e.BQk()),2&o){const t=r.ngIf;e.oxw();const i=e.MAs(38);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",i)}}function G(o,r){1&o&&(e.TgZ(0,"div",40),e._uU(1,"A\xfan no ha creado ninguna factura!"),e.qZA())}let H=(()=>{class o{constructor(t,i,l,g,_){this._athConfirmationService=t,this._changeDetectorRef=i,this._fileSaverService=l,this._router=g,this.store=_,this.invoices=[],this.emptyInvoice=T.pT,this.searchInputControl=new a.NI,this.selectedInvoice=null,this._unsubscribeAll=new s.x}ngOnInit(){this.invoices$=this.store.select(f),this.invoices$.pipe((0,c.R)(this._unsubscribeAll)).subscribe(t=>{this.invoices=t,this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createInvoice(){this._router.navigateByUrl("/invoices/new")}editInvoice(t){this._router.navigateByUrl(`/invoices/${t}`)}deleteInvoice(t){this._athConfirmationService.open({title:"Eliminar factura",message:"\xbfEst\xe1 seguro que que desea eliminar esta factura?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,c.R)(this._unsubscribeAll)).subscribe(l=>{"confirmed"===l&&this.store.dispatch((0,I.Q_)({id:t}))})}exportAsExcelFile(){this._fileSaverService.exportAsExcelFile(this.invoices,"invoices")}exportAsCsvFile(){this._fileSaverService.exportAsCsvFile(this.invoices,"invoices")}trackByFn(t,i){return i.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(U.C),e.Y36(e.sBO),e.Y36(L.m),e.Y36(d.F0),e.Y36(u.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ath-invoices"]],viewQuery:function(t,i){if(1&t&&(e.Gf(x.NW,5),e.Gf(p.YE,5)),2&t){let l;e.iGM(l=e.CRH())&&(i._paginator=l.first),e.iGM(l=e.CRH())&&(i._sort=l.first)}},decls:39,vars:8,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","pb-22","sm:pt-12","sm:pb-28","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700",3,"click"],[1,"text-mine-900",3,"svgIcon"],[1,"ml-2","mr-1","text-lg","text-mine-900"],[1,"flex-auto","p-6","-mt-16","bg-mine-200","shadow","sm:p-10","rounded-t-2xl","overflow-x-auto"],[1,"w-full","p-8","md:p-16","shadow","rounded-2xl","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-center","justify-between","mb-5"],[1,"text-2xl","font-semibold","leading-tight"],[1,"-mr-3"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["listInvoicesMenu","matMenu"],["mat-menu-item","",3,"click"],[4,"ngIf"],["noInvoices",""],[4,"ngIf","ngIfElse"],[1,"grid","overflow-x-auto"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","inline-flex","invoices-grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-mine-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","truncate","sm:block","w-2/12"],[1,"hidden","truncate","sm:block","w-1/12"],[1,"hidden","text-center","sm:block","w-1/12"],[1,"text-center","w-1/12"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inline-flex","invoices-grid","items-center","gap-4","px-6","py-3","border-b","md:px-8"],[1,"truncate","w-2/12"],[1,"hidden","truncate","w-1/12","sm:block"],[1,"flex","flex-col","justify-center","gap-1","sm:flex-row"],["mat-stroked-button","","matTooltip","Editar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Eliminar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e.TgZ(5,"div"),e.TgZ(6,"a",4),e._uU(7,"Facturas"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",5),e.TgZ(9,"a",6),e._UZ(10,"mat-icon",7),e.TgZ(11,"span",8),e._uU(12,"Regresar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",9),e.TgZ(14,"h2",10),e._uU(15," Registro de facturas "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",11),e.TgZ(17,"button",12),e.NdJ("click",function(){return i.createInvoice()}),e._UZ(18,"mat-icon",13),e.TgZ(19,"span",14),e._uU(20,"Nueva"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",15),e.TgZ(22,"div",16),e.TgZ(23,"div",17),e.TgZ(24,"div",18),e._uU(25,"Registro de facturas"),e.qZA(),e.TgZ(26,"div",19),e.TgZ(27,"button",20),e._UZ(28,"mat-icon",21),e.qZA(),e.TgZ(29,"mat-menu",null,22),e.TgZ(31,"button",23),e.NdJ("click",function(){return i.exportAsExcelFile()}),e._uU(32,"Exportar a excel"),e.qZA(),e.TgZ(33,"button",23),e.NdJ("click",function(){return i.exportAsCsvFile()}),e._uU(34,"Exportar a csv"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(35,V,2,2,"ng-container",24),e.ALo(36,"async"),e.YNc(37,G,2,0,"ng-template",null,25,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&t){const l=e.MAs(30);e.xp6(9),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(9),e.Q6J("matMenuTriggerFor",l),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:dots-vertical"),e.xp6(7),e.Q6J("ngIf",e.lcZ(36,6,i.invoices$))}},directives:[J.PQ,d.yS,Q.Hw,k.lW,C.p6,C.VK,C.OP,h.O5,p.YE,h.sg,M.gM],pipes:[h.Ov,h.JJ,h.uU],encapsulation:2,data:{animation:q.p},changeDetection:0}),o})();var w=n(8372),E=n(8675),R=n(3900),D=n(9646),z=n(9652),K=n(4787),W=n(6596),X=n(1158),Y=n(8891),y=n(1125),F=n(7322),ee=n(7531),te=n(4107),oe=n(508),ie=n(2368),N=n(1079);function ne(o,r){1&o&&(e.ynx(0),e.TgZ(1,"a",48),e._uU(2,"Nueva"),e.qZA(),e.BQk())}function re(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"a",48),e._uU(2),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Oqu(t.selectedInvoice.invoiceNo)}}function ae(o,r){1&o&&(e.ynx(0),e._uU(1," Nueva factura "),e.BQk())}function ce(o,r){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.selectedInvoice.invoiceNo," ")}}const B=function(o){return{"cursor-not-allowed":o}};function le(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().createInvoice()}),e._UZ(1,"mat-icon",50),e.TgZ(2,"span",51),e._uU(3,"Guardar"),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,B,t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid))("disabled",t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function se(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateInvoice()}),e._UZ(1,"mat-icon",50),e.TgZ(2,"span",51),e._uU(3,"Actualizar"),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,B,t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid))("disabled",t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}function me(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",44),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function ue(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El monto es obligatorio. "),e.qZA())}function de(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El monto m\xednimo debe ser mayor a 0. "),e.qZA())}function pe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El monto m\xe1ximo es de 10.000. "),e.qZA())}function ge(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.invoiceForm.get("amount").getError("maxAmount").value," ")}}function ve(o,r){if(1&o&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.idNumber," ")}}function fe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero de identificaci\xf3n es obligatorio. "),e.qZA())}function Ze(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function he(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido es obligatorio. "),e.qZA())}function _e(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La direcci\xf3n del remesante es obligatoria. "),e.qZA())}function xe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero de identificaci\xf3n es obligatorio. "),e.qZA())}function Ae(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero de identificaci\xf3n es incorrecto. "),e.qZA())}function Te(o,r){if(1&o&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.idNumber," ")}}function Ie(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function be(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido es obligatorio. "),e.qZA())}function qe(o,r){if(1&o&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ye(o,r){if(1&o&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.city),e.xp6(1),e.hij("",t.city," ")}}function Fe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La direcci\xf3n del remesante es obligatoria. "),e.qZA())}const Ce=(0,z.kP)("1234567890GHIJKL",8);let Ne=(()=>{class o{constructor(t,i,l,g,_,we,Ee,Re){this._activatedRoute=t,this._athConfirmationService=i,this._changeDetectorRef=l,this._formBuilder=g,this._locationService=_,this._router=we,this.store=Ee,this.invoiceService=Re,this.cities=[],this.editMode=!1,this.formSubmitted=!1,this.invoice$=(0,D.of)(null),this.invoiceId=null,this.isValid=!1,this.selectedInvoice=T.pT,this.selectedState=null,this.showAlert=!1,this.states=[],this.user$=(0,D.of)(null),this._unsubscribeAll=new s.x}ngOnInit(){var t;this.user$=this.store.select(K.dy),this.user$.pipe((0,c.R)(this._unsubscribeAll)).subscribe(i=>{this.user=i,this._changeDetectorRef.markForCheck()}),this.accounts$=this.store.select(W.L3),this._locationService.states$.pipe((0,c.R)(this._unsubscribeAll)).subscribe(i=>{this.states=i,this._changeDetectorRef.markForCheck()}),this._activatedRoute.params.pipe((0,c.R)(this._unsubscribeAll)).subscribe(({invoiceId:i})=>{this.invoiceId=i,"new"!==i&&(this.editMode=!0),this._changeDetectorRef.markForCheck()}),this.invoiceForm=this._formBuilder.group({_id:[null],userId:[this.user._id,[a.kI.required]],createdAt:[null],invoiceNo:[{disabled:!0,value:Ce()},[a.kI.required]],accountId:[null,[a.kI.required]],amount:[0,[a.kI.required,a.kI.min(0),a.kI.max(1e4)]],fincimexTax:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0)]],sendFincimex:[!0,[a.kI.required]]}),this.remitterForm=this._formBuilder.group({name:[null,[a.kI.required]],lastName1:[null,[a.kI.required]],lastName2:[null],address:[null,[a.kI.required]],idNumber:[null,[a.kI.required]],totalAmount:[null]}),this.beneficiaryForm=this._formBuilder.group({idNumber:[null,[a.kI.required,a.kI.maxLength(11)]],cardNo:[null,[a.kI.required]],deposit:[null,[a.kI.required]],name:[null,[a.kI.required]],lastName1:[null,[a.kI.required]],lastName2:[null],state:[null,[a.kI.required]],city:[null,[a.kI.required]],town:[null,[a.kI.required]],address:[null,[a.kI.required]],phoneNumber:[null,[a.kI.required]],note:[null,[a.kI.required]]}),this.invoice$=this.store.select(A),this.invoice$.pipe((0,c.R)(this._unsubscribeAll)).subscribe(i=>{this.selectedInvoice=i,null!==i&&this.editMode&&(this.invoiceForm.patchValue(this.selectedInvoice),this.remitterForm.patchValue(this.selectedInvoice.remitter),this.beneficiaryForm.patchValue(this.selectedInvoice.beneficiary)),this._changeDetectorRef.markForCheck()}),null===(t=this.beneficiaryForm.get("state"))||void 0===t||t.valueChanges.pipe((0,c.R)(this._unsubscribeAll)).subscribe(i=>{this._getCitiesByState(i),this._changeDetectorRef.markForCheck()}),this.invoiceForm.get("amount").valueChanges.pipe((0,c.R)(this._unsubscribeAll)).subscribe(i=>{const l=this.remitterForm.getRawValue();l.totalAmount&&l.totalAmount+ +i>1e4?this.invoiceForm.get("amount").setErrors({maxAmount:{value:"El remesante seleccionado supera el importe m\xe1ximo en este per\xedodo."}}):l.totalAmount&&this.invoiceForm.get("amount").hasError("maxAmount")&&this.invoiceForm.get("amount").setErrors(null)}),this.filteredRemitters=this.remitterForm.get("idNumber").valueChanges.pipe((0,c.R)(this._unsubscribeAll),(0,w.b)(600),(0,E.O)(""),(0,R.w)(i=>this.invoiceService.searchRemitterByIdNumber(i))),this.filteredBeneficiaries=this.beneficiaryForm.get("idNumber").valueChanges.pipe((0,c.R)(this._unsubscribeAll),(0,w.b)(600),(0,E.O)(""),(0,R.w)(i=>this.invoiceService.searchBeneficiaryByIdNumber(i)))}createInvoice(){const t=this.remitterForm.getRawValue(),i=this.beneficiaryForm.getRawValue(),l=this.invoiceForm.getRawValue(),g=Object.assign(Object.assign({},l),{remitter:t,beneficiary:i}),_={title:"Crear Factura",action:(0,I.BH)({invoice:g})};this.openDialog(_)}updateInvoice(){const t=this.remitterForm.getRawValue(),i=this.beneficiaryForm.getRawValue(),l=this.invoiceForm.getRawValue(),g=Object.assign(Object.assign({},l),{remitter:t,beneficiary:i}),_={title:"Actualizar Factura",action:(0,I.PA)({invoice:g})};this.openDialog(_)}fillRemitter(t){const i=t.option.value;i.totalAmount+this.invoiceForm.get("amount").value>1e4&&this.invoiceForm.get("amount").setErrors({maxAmount:{value:"El remesante selecionado supera el importe m\xe1ximo en este per\xedodo."}}),this.remitterForm.patchValue(i)}fillBeneficiary(t){this.beneficiaryForm.patchValue(t.option.value)}_getCitiesByState(t){t!==this.selectedState&&this._locationService.getCitiesByState(t).pipe((0,c.R)(this._unsubscribeAll)).subscribe(i=>{this.cities=i,this._changeDetectorRef.markForCheck()})}openDialog(t){this._athConfirmationService.open({title:t.title,message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,c.R)(this._unsubscribeAll)).subscribe(l=>{"confirmed"===l&&this.store.dispatch(t.action)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.gz),e.Y36(U.C),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(X.a),e.Y36(d.F0),e.Y36(u.yh),e.Y36(Y.x))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ath-invoice-detail"]],decls:190,vars:93,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700","hover:underline",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl","text-mine-900"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 rounded-sm bg-primary-700 hover:shadow-lg","mat-button","",3,"ngClass","disabled","click",4,"ngIf"],["class","ml-4 rounded-sm bg-primary-700 hover:shadow-lg","mat-button","","mat-button","",3,"ngClass","disabled","click",4,"ngIf"],[1,"flex-auto","p-6","bg-mine-200","shadow","sm:p-10","rounded-t-2xl"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"w-full"],[3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[3,"formGroup","autocomplete"],[1,"grid","w-full","gap-6","p-8","mb-6","border-t-2","sm:grid-cols-4"],[1,"sm:col-span-2"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","required","",3,"type","formControlName"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,""],[1,"flex","flex-col"],[1,"mb-4","font-medium"],[3,"formControlName","color"],["placeholder","Escriba el N\xfamero de Identidad o Pasaporte","aria-label","Number","matInput","","required","",3,"type","formControlName","matAutocomplete"],["autoActiveFirstOption","",3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","",3,"type","formControlName","placeholder"],[1,"sm:col-span-4"],["matInput","","required","",3,"placeholder","formControlName"],[1,"grid","w-full","gap-6","p-8","mb-6","border-t-2","sm:grid-cols-2","md:grid-cols-4"],["autob","matAutocomplete"],["matInput","",3,"type","formControlName"],[3,"value"],[1,"sm:col-span-3"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"placeholder","formControlName"],[1,"ml-1","text-primary-700"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700","hover:shadow-lg",3,"ngClass","disabled","click"],[1,"text-mine-900",3,"svgIcon"],[1,"ml-2","mr-1","text-lg","text-mine-900"],["mat-button","","mat-button","",1,"ml-4","rounded-sm","bg-primary-700","hover:shadow-lg",3,"ngClass","disabled","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"a",5),e._uU(7,"Facturas"),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.YNc(10,ne,3,0,"ng-container",7),e.YNc(11,re,3,1,"ng-container",7),e.qZA(),e.qZA(),e.TgZ(12,"div",8),e.TgZ(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",11),e.TgZ(18,"div",12),e.YNc(19,ae,2,0,"ng-container",7),e.YNc(20,ce,2,1,"ng-container",7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",13),e.YNc(22,le,4,5,"button",14),e.YNc(23,se,4,5,"button",15),e.qZA(),e.qZA(),e.TgZ(24,"div",16),e.TgZ(25,"div",17),e.TgZ(26,"mat-accordion",18),e.TgZ(27,"mat-expansion-panel",19),e.TgZ(28,"mat-expansion-panel-header",20),e.TgZ(29,"mat-panel-title",21),e.TgZ(30,"div",22),e._uU(31," Informaci\xf3n General "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"form",23),e.TgZ(33,"div",24),e.TgZ(34,"div",25),e.TgZ(35,"mat-form-field",26),e.TgZ(36,"mat-label"),e._uU(37,"N\xfamero de Factura"),e.qZA(),e._UZ(38,"input",27),e.qZA(),e.qZA(),e.TgZ(39,"div",25),e.TgZ(40,"mat-form-field",26),e.TgZ(41,"mat-label"),e._uU(42,"Seleccione la cuenta "),e.qZA(),e.TgZ(43,"mat-select",28),e.YNc(44,me,3,2,"ng-container",29),e.ALo(45,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(46,"div",30),e.TgZ(47,"mat-form-field",26),e.TgZ(48,"mat-label"),e._uU(49,"Importe (10.000 m\xe1x)"),e.qZA(),e._UZ(50,"input",27),e.YNc(51,ue,2,0,"mat-error",7),e.YNc(52,de,2,0,"mat-error",7),e.YNc(53,pe,2,0,"mat-error",7),e.YNc(54,ge,2,1,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(55,"div",30),e.TgZ(56,"mat-form-field",26),e.TgZ(57,"mat-label"),e._uU(58,"Comisi\xf3n de Fincimex"),e.qZA(),e._UZ(59,"input",27),e.qZA(),e.qZA(),e.TgZ(60,"div",25),e.TgZ(61,"div",31),e.TgZ(62,"span",32),e._uU(63,"\xbfEnviar a Fincimex?"),e.qZA(),e.TgZ(64,"mat-slide-toggle",33),e._uU(65),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(66,"mat-expansion-panel"),e.TgZ(67,"mat-expansion-panel-header",20),e.TgZ(68,"mat-panel-title",21),e.TgZ(69,"div",22),e._uU(70," Informaci\xf3n del Remesante "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(71,"form",23),e.TgZ(72,"div",24),e.TgZ(73,"div",25),e.TgZ(74,"mat-form-field",26),e.TgZ(75,"mat-label"),e._uU(76,"Buscar por N\xfamero de Identidad o Pasaporte"),e.qZA(),e._UZ(77,"input",34),e.TgZ(78,"mat-autocomplete",35,36),e.NdJ("optionSelected",function(g){return i.fillRemitter(g)}),e.YNc(80,ve,2,2,"mat-option",37),e.ALo(81,"async"),e.qZA(),e.YNc(82,fe,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(83,"div",25),e.TgZ(84,"mat-form-field",26),e.TgZ(85,"mat-label"),e._uU(86,"Nombre"),e.qZA(),e._UZ(87,"input",38),e.YNc(88,Ze,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(89,"div",25),e.TgZ(90,"mat-form-field",26),e.TgZ(91,"mat-label"),e._uU(92,"Primer Apellido"),e.qZA(),e._UZ(93,"input",27),e.YNc(94,he,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(95,"div",25),e.TgZ(96,"mat-form-field",26),e.TgZ(97,"mat-label"),e._uU(98,"Segundo Apellido"),e.qZA(),e._UZ(99,"input",27),e.qZA(),e.qZA(),e.TgZ(100,"div",39),e.TgZ(101,"mat-form-field",26),e.TgZ(102,"mat-label"),e._uU(103,"Direcci\xf3n"),e.qZA(),e._UZ(104,"textarea",40),e.YNc(105,_e,2,0,"mat-error",7),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(106,"mat-expansion-panel"),e.TgZ(107,"mat-expansion-panel-header",20),e.TgZ(108,"mat-panel-title",21),e.TgZ(109,"div",22),e._uU(110," Informaci\xf3n del Beneficiario "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(111,"form",23),e.TgZ(112,"div",41),e.TgZ(113,"div",30),e.TgZ(114,"mat-form-field",26),e.TgZ(115,"mat-label"),e._uU(116,"Buscar por N\xfamero de Identidad o Pasaporte"),e.qZA(),e._UZ(117,"input",34),e.YNc(118,xe,2,0,"mat-error",7),e.YNc(119,Ae,2,0,"mat-error",7),e.TgZ(120,"mat-autocomplete",35,42),e.NdJ("optionSelected",function(g){return i.fillBeneficiary(g)}),e.YNc(122,Te,2,2,"mat-option",37),e.ALo(123,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(124,"div",30),e.TgZ(125,"mat-form-field",26),e.TgZ(126,"mat-label"),e._uU(127,"Nombre"),e.qZA(),e._UZ(128,"input",38),e.YNc(129,Ie,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(130,"div",30),e.TgZ(131,"mat-form-field",26),e.TgZ(132,"mat-label"),e._uU(133,"Primer Apellido"),e.qZA(),e._UZ(134,"input",27),e.YNc(135,be,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(136,"div",30),e.TgZ(137,"mat-form-field",26),e.TgZ(138,"mat-label"),e._uU(139,"Segundo Apellido"),e.qZA(),e._UZ(140,"input",43),e.qZA(),e.qZA(),e.TgZ(141,"div",30),e.TgZ(142,"mat-form-field",26),e.TgZ(143,"mat-label"),e._uU(144,"Depositar en"),e.qZA(),e.TgZ(145,"mat-select",28),e.TgZ(146,"mat-option",44),e._uU(147,"Tarjeta"),e.qZA(),e.TgZ(148,"mat-option",44),e._uU(149,"Cuenta"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(150,"div",45),e.TgZ(151,"mat-form-field",26),e.TgZ(152,"mat-label"),e._uU(153,"N\xfamero de cuenta o de tarjeta"),e.qZA(),e._UZ(154,"input",27),e.qZA(),e.qZA(),e.TgZ(155,"div",25),e.TgZ(156,"mat-form-field",26),e.TgZ(157,"mat-label"),e._uU(158,"Provincia"),e.qZA(),e._UZ(159,"mat-icon",46),e.TgZ(160,"mat-select",28),e.YNc(161,qe,2,2,"mat-option",37),e.qZA(),e.qZA(),e.qZA(),e.TgZ(162,"div",25),e.TgZ(163,"mat-form-field",26),e.TgZ(164,"mat-label"),e._uU(165,"Municipio"),e.qZA(),e._UZ(166,"mat-icon",46),e.TgZ(167,"mat-select",28),e.YNc(168,ye,2,2,"mat-option",37),e.qZA(),e.qZA(),e.qZA(),e.TgZ(169,"div",39),e.TgZ(170,"mat-form-field",26),e.TgZ(171,"mat-label"),e._uU(172,"Direcci\xf3n"),e.qZA(),e._UZ(173,"textarea",40),e.YNc(174,Fe,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(175,"div",25),e.TgZ(176,"mat-form-field",26),e.TgZ(177,"mat-label"),e._uU(178,"Reparto o Consejo Popular"),e.qZA(),e._UZ(179,"input",27),e.qZA(),e.qZA(),e.TgZ(180,"div",25),e.TgZ(181,"mat-form-field",26),e.TgZ(182,"mat-label"),e._uU(183,"Tel\xe9fono"),e.qZA(),e._UZ(184,"input",27),e.qZA(),e.qZA(),e.TgZ(185,"div",39),e.TgZ(186,"mat-form-field",26),e.TgZ(187,"mat-label"),e._uU(188,"Observaciones"),e.qZA(),e._UZ(189,"textarea",47),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const l=e.MAs(79),g=e.MAs(121);e.xp6(6),e.Q6J("routerLink","/invoices"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("ngIf","new"===i.invoiceId),e.xp6(1),e.Q6J("ngIf","new"!==i.invoiceId&&null!==i.selectedInvoice),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(5),e.Q6J("ngIf","new"===i.invoiceId),e.xp6(1),e.Q6J("ngIf","new"!==i.invoiceId&&null!==i.selectedInvoice),e.xp6(2),e.Q6J("ngIf","new"===i.invoiceId),e.xp6(1),e.Q6J("ngIf","new"!==i.invoiceId),e.xp6(4),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(4),e.Q6J("formGroup",i.invoiceForm)("autocomplete","off"),e.xp6(6),e.Q6J("type","text")("formControlName","invoiceNo"),e.xp6(5),e.Q6J("formControlName","accountId"),e.xp6(1),e.Q6J("ngForOf",e.lcZ(45,87,i.accounts$)),e.xp6(6),e.Q6J("type","number")("formControlName","amount"),e.xp6(1),e.Q6J("ngIf",i.invoiceForm.get("amount").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.invoiceForm.get("amount").hasError("min")),e.xp6(1),e.Q6J("ngIf",i.invoiceForm.get("amount").hasError("max")),e.xp6(1),e.Q6J("ngIf",i.invoiceForm.get("amount").hasError("maxAmount")),e.xp6(5),e.Q6J("type","number")("formControlName","fincimexTax"),e.xp6(5),e.Q6J("formControlName","sendFincimex")("color","primary"),e.xp6(1),e.hij(" ",!0===i.invoiceForm.get("sendFincimex").value?"Enviar":"No enviar"," "),e.xp6(2),e.Q6J("collapsedHeight","56px"),e.xp6(4),e.Q6J("formGroup",i.remitterForm)("autocomplete","off"),e.xp6(6),e.Q6J("type","text")("formControlName","idNumber")("matAutocomplete",l),e.xp6(3),e.Q6J("ngForOf",e.lcZ(81,89,i.filteredRemitters)),e.xp6(2),e.Q6J("ngIf",i.remitterForm.get("idNumber").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre"),e.xp6(1),e.Q6J("ngIf",i.remitterForm.get("name").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName1"),e.xp6(1),e.Q6J("ngIf",i.remitterForm.get("lastName1").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName2"),e.xp6(5),e.Q6J("placeholder","Direcci\xf3n del remesante")("formControlName","address"),e.xp6(1),e.Q6J("ngIf",i.remitterForm.get("address").hasError("required")),e.xp6(2),e.Q6J("collapsedHeight","56px"),e.xp6(4),e.Q6J("formGroup",i.beneficiaryForm)("autocomplete","off"),e.xp6(6),e.Q6J("type","text")("formControlName","idNumber")("matAutocomplete",g),e.xp6(1),e.Q6J("ngIf",i.beneficiaryForm.get("idNumber").hasError("required")),e.xp6(1),e.Q6J("ngIf",i.beneficiaryForm.get("idNumber").hasError("maxLength")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(123,91,i.filteredBeneficiaries)),e.xp6(6),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre"),e.xp6(1),e.Q6J("ngIf",i.beneficiaryForm.get("name").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName1"),e.xp6(1),e.Q6J("ngIf",i.beneficiaryForm.get("lastName1").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName2"),e.xp6(5),e.Q6J("formControlName","deposit"),e.xp6(1),e.Q6J("value","Card"),e.xp6(2),e.Q6J("value","Bank account"),e.xp6(6),e.Q6J("type","text")("formControlName","cardNo"),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:map"),e.xp6(1),e.Q6J("formControlName","state"),e.xp6(1),e.Q6J("ngForOf",i.states),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:location-marker"),e.xp6(1),e.Q6J("formControlName","city"),e.xp6(1),e.Q6J("ngForOf",i.cities),e.xp6(5),e.Q6J("placeholder","Direcci\xf3n del remesante")("formControlName","address"),e.xp6(1),e.Q6J("ngIf",i.beneficiaryForm.get("address").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","town"),e.xp6(5),e.Q6J("type","text")("formControlName","phoneNumber"),e.xp6(5),e.Q6J("placeholder","Escriba cualquier comentario que considere oportuno")("formControlName","note")}},directives:[J.PQ,d.yS,Q.Hw,h.O5,k.lW,h.mk,y.pp,y.ib,y.yz,y.yK,a._Y,a.JL,a.sg,F.KE,F.hX,ee.Nt,a.Fj,a.Q7,a.JJ,a.u,te.gD,h.sg,oe.ey,F.TO,ie.Rr,N.ZL,N.XC,F.qo],pipes:[h.Ov],encapsulation:2,data:{animation:q.p},changeDetection:0}),o})(),O=(()=>{class o{constructor(t){this.store=t}resolve(t,i){return this.store.dispatch((0,I.sL)())}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(u.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ue=(()=>{class o{constructor(t,i){this.store=t,this._invoiceService=i}resolve(t,i){const l=t.params.invoiceId;if("new"!==l)return this.store.dispatch((0,I.XD)({invoiceId:l}))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(u.yh),e.LFG(Y.x))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var S=n(5497),Je=n(7681);const Qe=[{path:"",component:H,resolve:{invoices:O,users:S.o}},{path:":invoiceId",component:Ne,resolve:{accounts:Je.$c,invoice:Ue,invoices:O,users:S.o}}];let ke=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[d.Bz.forChild(Qe),N.Bb,v.m]]}),o})()},9652:(b,Z,n)=>{n.d(Z,{kP:()=>a});let d=p=>crypto.getRandomValues(new Uint8Array(p)),a=(p,s=21)=>((p,s,c)=>{let u=(2<<Math.log(p.length-1)/Math.LN2)-1,m=-~(1.6*u*s/p.length);return(A=s)=>{let f="";for(;;){let q=c(m),T=m;for(;T--;)if(f+=p[q[T]&u]||"",f.length===A)return f}}})(p,s,d)}}]);