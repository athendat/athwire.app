"use strict";(self.webpackChunkath=self.webpackChunkath||[]).push([[225],{5736:(b,h,n)=>{n.d(h,{AR:()=>p,pT:()=>f,$w:()=>g,SX:()=>a,YK:()=>d});const p={_id:null,userId:null,active:!0,owner:null,currency:null,name:null,balance:0,createdAt:null,updatedAt:null},f={_id:null,userId:null,createdAt:null,accountId:null,transactionId:null,invoiceNo:0,amount:0,fincimexTax:0,sendfincimex:!1,remitter:void 0,beneficiary:void 0},g={_id:null,accountId:null,userId:null,reference:null,date:null,valueDate:null,description:null,origin:null,destiny:null,accountOrigin:null,accountDestiny:null,operationType:null,currency:null,initBalance:null,amount:null,endBalance:null},a={_id:null,active:!0,name:null,lastname:null,email:null,password:null,roles:[null]},d={_id:null,invoiceId:"",transactionId:0,reason:"",canceled:!1,fincimexResponse:""}},7681:(b,h,n)=>{n.d(h,{$c:()=>a,EW:()=>d,$G:()=>u});var p=n(7078),f=n(5e3),g=n(5620);let a=(()=>{class s{constructor(m){this.store=m}resolve(m,A){return this.store.dispatch((0,p.vP)())}}return s.\u0275fac=function(m){return new(m||s)(f.LFG(g.yh))},s.\u0275prov=f.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),d=(()=>{class s{constructor(m){this.store=m}resolve(m,A){const Z=m.params.accountId;if("new"!==Z)return this.store.dispatch((0,p.Mx)({accountId:Z}))}}return s.\u0275fac=function(m){return new(m||s)(f.LFG(g.yh))},s.\u0275prov=f.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),u=(()=>{class s{constructor(m){this.store=m}resolve(m,A){const Z=m.params.accountId;if("new"!==Z)return this.store.dispatch((0,p.vg)({accountId:Z}))}}return s.\u0275fac=function(m){return new(m||s)(f.LFG(g.yh))},s.\u0275prov=f.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},6596:(b,h,n)=>{n.d(h,{bk:()=>g,L3:()=>a,Cj:()=>d});var p=n(5620);const f=u=>u.account,g=(0,p.P1)(f,u=>u.account),a=(0,p.P1)(f,u=>u.accounts),d=(0,p.P1)(f,u=>u.operations)},8225:(b,h,n)=>{n.r(h),n.d(h,{InvoicesModule:()=>De});var p=n(5357),f=n(2455),g=n(345),a=n(3075),d=n(6087),u=n(4847),s=n(7579),l=n(2722),m=n(5620);const A=i=>i.invoice,Z=(0,m.P1)(A,i=>i.invoice),y=(0,m.P1)(A,i=>i.invoices);var T=n(5700),U=n(5736),e=n(5e3),J=n(7967),L=n(1927),Q=n(5303),k=n(5245),D=n(7423),F=n(2181),_=n(9808),M=n(7238);function j(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",34),e.TgZ(2,"div",35),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",36),e._uU(7),e.qZA(),e.TgZ(8,"div",36),e._uU(9),e.qZA(),e.TgZ(10,"div",36),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"div",36),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"div",36),e._uU(17," Test "),e.qZA(),e.TgZ(18,"div",36),e._uU(19),e.ALo(20,"date"),e.qZA(),e.TgZ(21,"div",36),e._uU(22),e.qZA(),e.TgZ(23,"div",36),e._uU(24),e.qZA(),e.TgZ(25,"div",37),e.TgZ(26,"button",38),e.NdJ("click",function(){const v=e.CHM(t).$implicit;return e.oxw(4).editInvoice(v._id)}),e._UZ(27,"mat-icon",21),e.qZA(),e.TgZ(28,"button",39),e.NdJ("click",function(){const v=e.CHM(t).$implicit;return e.oxw(4).deleteInvoice(v._id)}),e._UZ(29,"mat-icon",21),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&i){const t=r.$implicit;e.xp6(3),e.hij(" ",t.invoiceNo," "),e.xp6(2),e.lnq(" ",t.remitter.name," ",t.remitter.lastName1," ",t.remitter.lastName2," "),e.xp6(2),e.lnq(" ",t.beneficiary.name," ",t.beneficiary.lastName1," ",t.beneficiary.lastName2," "),e.xp6(2),e.hij(" ",t.beneficiary.cardNo," "),e.xp6(2),e.hij(" ",e.xi3(12,15,t.amount,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(15,18,t.fincimexTax,"1.2-2")," "),e.xp6(5),e.hij(" ",e.xi3(20,21,t.createdAt,"short")," "),e.xp6(3),e.hij(" ",t.accountId.name," "),e.xp6(2),e.hij(" ",t.transactionId," "),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function P(i,r){if(1&i&&(e.ynx(0),e.YNc(1,j,30,24,"ng-container",33),e.BQk()),2&i){const t=r.ngIf,o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",o.trackByFn)}}function $(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"div",27),e.TgZ(2,"div",28),e.TgZ(3,"div",29),e._uU(4," No.Factura "),e.qZA(),e.TgZ(5,"div",30),e._uU(6," Remesante "),e.qZA(),e.TgZ(7,"div",30),e._uU(8," Beneficiario "),e.qZA(),e.TgZ(9,"div",31),e._uU(10," Tarjeta "),e.qZA(),e.TgZ(11,"div",31),e._uU(12," Importe "),e.qZA(),e.TgZ(13,"div",31),e._uU(14," TAX Fincimex "),e.qZA(),e.TgZ(15,"div",31),e._uU(16," Estado "),e.qZA(),e.TgZ(17,"div",31),e._uU(18," Fecha y Hora "),e.qZA(),e.TgZ(19,"div",31),e._uU(20," Cuenta "),e.qZA(),e.TgZ(21,"div",31),e._uU(22," ID Transacci\xf3n "),e.qZA(),e.TgZ(23,"div",32),e._uU(24," Acciones "),e.qZA(),e.qZA(),e.YNc(25,P,2,2,"ng-container",24),e.ALo(26,"async"),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(25),e.Q6J("ngIf",e.lcZ(26,1,t.invoices$))}}function V(i,r){if(1&i&&(e.ynx(0),e.YNc(1,$,27,3,"ng-container",26),e.BQk()),2&i){const t=r.ngIf;e.oxw();const o=e.MAs(38);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",o)}}function G(i,r){1&i&&(e.TgZ(0,"div",40),e._uU(1,"A\xfan no ha creado ninguna factura!"),e.qZA())}let H=(()=>{class i{constructor(t,o,c,v,x){this._athConfirmationService=t,this._changeDetectorRef=o,this._fileSaverService=c,this._router=v,this.store=x,this.invoices=[],this.emptyInvoice=U.pT,this.searchInputControl=new a.NI,this.selectedInvoice=null,this._unsubscribeAll=new s.x}ngOnInit(){this.invoices$=this.store.select(y),this.invoices$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(t=>{this.invoices=t,this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createInvoice(){this._router.navigateByUrl("/invoices/new")}editInvoice(t){this._router.navigateByUrl(`/invoices/${t}`)}deleteInvoice(t){this._athConfirmationService.open({title:"Eliminar factura",message:"\xbfEst\xe1 seguro que que desea eliminar esta factura?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,l.R)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&this.store.dispatch((0,g.Q_)({id:t}))})}exportAsExcelFile(){this._fileSaverService.exportAsExcelFile(this.invoices,"invoices")}exportAsCsvFile(){this._fileSaverService.exportAsCsvFile(this.invoices,"invoices")}toggleDetails(t){if(this.selectedInvoice&&this.selectedInvoice._id===t)return this.closeDetails(),void this.store.dispatch((0,g.sV)());this.store.dispatch((0,g.XD)({invoiceId:t}))}closeDetails(){this.selectedInvoice=null}trackByFn(t,o){return o.id||t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(J.C),e.Y36(e.sBO),e.Y36(L.m),e.Y36(p.F0),e.Y36(m.yh))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ath-invoices"]],viewQuery:function(t,o){if(1&t&&(e.Gf(d.NW,5),e.Gf(u.YE,5)),2&t){let c;e.iGM(c=e.CRH())&&(o._paginator=c.first),e.iGM(c=e.CRH())&&(o._sort=c.first)}},decls:39,vars:8,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","pb-22","sm:pt-12","sm:pb-28","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700",3,"click"],[1,"text-mine-900",3,"svgIcon"],[1,"ml-2","mr-1","text-lg","text-mine-900"],[1,"flex-auto","p-6","-mt-16","bg-mine-200","shadow","sm:p-10","rounded-t-2xl","overflow-x-auto"],[1,"w-full","p-8","md:p-16","shadow","rounded-2xl","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-center","justify-between","mb-5"],[1,"text-2xl","font-semibold","leading-tight"],[1,"-mr-3"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"icon-size-5",3,"svgIcon"],["listInvoicesMenu","matMenu"],["mat-menu-item","",3,"click"],[4,"ngIf"],["noInvoices",""],[4,"ngIf","ngIfElse"],[1,"grid","overflow-x-auto"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","inline-flex","invoices-grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-mine-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","truncate","sm:block","w-2/12"],[1,"hidden","truncate","sm:block","w-1/12"],[1,"hidden","text-center","sm:block","w-1/12"],[1,"text-center","w-1/12"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inline-flex","invoices-grid","items-center","gap-4","px-6","py-3","border-b","md:px-8"],[1,"truncate","w-2/12"],[1,"hidden","truncate","w-1/12","sm:block"],[1,"flex","flex-col","justify-center","gap-1","sm:flex-row"],["mat-stroked-button","","matTooltip","Editar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Eliminar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e.TgZ(5,"div"),e.TgZ(6,"a",4),e._uU(7,"Facturas"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",5),e.TgZ(9,"a",6),e._UZ(10,"mat-icon",7),e.TgZ(11,"span",8),e._uU(12,"Regresar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",9),e.TgZ(14,"h2",10),e._uU(15," Registro de facturas "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",11),e.TgZ(17,"button",12),e.NdJ("click",function(){return o.createInvoice()}),e._UZ(18,"mat-icon",13),e.TgZ(19,"span",14),e._uU(20,"Nueva"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",15),e.TgZ(22,"div",16),e.TgZ(23,"div",17),e.TgZ(24,"div",18),e._uU(25,"Registro de facturas"),e.qZA(),e.TgZ(26,"div",19),e.TgZ(27,"button",20),e._UZ(28,"mat-icon",21),e.qZA(),e.TgZ(29,"mat-menu",null,22),e.TgZ(31,"button",23),e.NdJ("click",function(){return o.exportAsExcelFile()}),e._uU(32,"Exportar a excel"),e.qZA(),e.TgZ(33,"button",23),e.NdJ("click",function(){return o.exportAsCsvFile()}),e._uU(34,"Exportar a csv"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(35,V,2,2,"ng-container",24),e.ALo(36,"async"),e.YNc(37,G,2,0,"ng-template",null,25,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&t){const c=e.MAs(30);e.xp6(9),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(9),e.Q6J("matMenuTriggerFor",c),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:dots-vertical"),e.xp6(7),e.Q6J("ngIf",e.lcZ(36,6,o.invoices$))}},directives:[Q.PQ,p.yS,k.Hw,D.lW,F.p6,F.VK,F.OP,_.O5,u.YE,_.sg,M.gM],pipes:[_.Ov,_.JJ,_.uU],encapsulation:2,data:{animation:T.p},changeDetection:0}),i})();var z=n(9300),R=n(8372),w=n(8675),E=n(3900),C=n(9646),K=n(9652),W=n(4787),X=n(6596),ee=n(1158),Y=n(8891),I=n(1125),q=n(7322),te=n(7531),ie=n(4107),oe=n(508),ne=n(2368),N=n(1079);function re(i,r){1&i&&(e.ynx(0),e.TgZ(1,"a",48),e._uU(2,"Nueva"),e.qZA(),e.BQk())}function ae(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"a",48),e._uU(2),e.qZA(),e.BQk()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.selectedInvoice.invoiceNo)}}function ce(i,r){1&i&&(e.ynx(0),e._uU(1," Nueva factura "),e.BQk())}function le(i,r){if(1&i&&(e.ynx(0),e._uU(1),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.selectedInvoice.invoiceNo," ")}}const O=function(i){return{"cursor-not-allowed":i}};function se(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().createInvoice()}),e._UZ(1,"mat-icon",50),e.TgZ(2,"span",51),e._uU(3,"Guardar"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,O,t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid))("disabled",t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function me(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateInvoice()}),e._UZ(1,"mat-icon",50),e.TgZ(2,"span",51),e._uU(3,"Actualizar"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,O,t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid))("disabled",t.invoiceForm.invalid||t.remitterForm.invalid||t.beneficiaryForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}function ue(i,r){if(1&i&&(e.ynx(0),e.TgZ(1,"mat-option",44),e._uU(2),e.qZA(),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function de(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El monto es obligatorio. "),e.qZA())}function pe(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El monto m\xednimo debe ser mayor a 0. "),e.qZA())}function ge(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El monto m\xe1ximo es de 10.000. "),e.qZA())}function ve(i,r){if(1&i&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.invoiceForm.get("amount").getError("maxAmount").value," ")}}function fe(i,r){if(1&i&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.idNumber," ")}}function Ze(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero de identificaci\xf3n es obligatorio. "),e.qZA())}function he(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function _e(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido es obligatorio. "),e.qZA())}function xe(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," La direcci\xf3n del remesante es obligatoria. "),e.qZA())}function Ae(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero de identificaci\xf3n es obligatorio. "),e.qZA())}function Te(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El n\xfamero de identificaci\xf3n es incorrecto. "),e.qZA())}function be(i,r){if(1&i&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.idNumber," ")}}function Ie(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function qe(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido es obligatorio. "),e.qZA())}function ye(i,r){if(1&i&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Fe(i,r){if(1&i&&(e.TgZ(0,"mat-option",44),e._uU(1),e.qZA()),2&i){const t=r.$implicit;e.Q6J("value",t.city),e.xp6(1),e.hij("",t.city," ")}}function Ce(i,r){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," La direcci\xf3n del remesante es obligatoria. "),e.qZA())}const Ne=(0,K.kP)("1234567890GHIJKL",8);let Ue=(()=>{class i{constructor(t,o,c,v,x,Re,we,Ee){this._activatedRoute=t,this._athConfirmationService=o,this._changeDetectorRef=c,this._formBuilder=v,this._locationService=x,this._router=Re,this.store=we,this.invoiceService=Ee,this.cities=[],this.editMode=!1,this.formSubmitted=!1,this.invoice$=(0,C.of)(null),this.invoiceId=null,this.isValid=!1,this.selectedInvoice=U.pT,this.selectedInvoice$=(0,C.of)(null),this.selectedState=null,this.showAlert=!1,this.states=[],this.user$=(0,C.of)(null),this._unsubscribeAll=new s.x}ngOnInit(){var t;this.user$=this.store.select(W.dy),this.user$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(o=>{this.user=o,this._changeDetectorRef.markForCheck()}),this.accounts$=this.store.select(X.L3),this.selectedInvoice$=this.store.select(Z),this._locationService.states$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(o=>{this.states=o,this._changeDetectorRef.markForCheck()}),this._activatedRoute.params.pipe((0,l.R)(this._unsubscribeAll)).subscribe(({invoiceId:o})=>{this.invoiceId=o,"new"!==o&&(this.editMode=!0),this._changeDetectorRef.markForCheck()}),this.invoiceForm=this._formBuilder.group({_id:[null],userId:[this.user._id,[a.kI.required]],createdAt:[null],invoiceNo:[{disabled:!0,value:Ne()},[a.kI.required]],accountId:[null,[a.kI.required]],amount:[0,[a.kI.required,a.kI.min(0),a.kI.max(1e4)]],fincimexTax:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0)]],sendFincimex:[!0,[a.kI.required]]}),this.remitterForm=this._formBuilder.group({name:[null,[a.kI.required]],lastName1:[null,[a.kI.required]],lastName2:[null],address:[null,[a.kI.required]],idNumber:[null,[a.kI.required]],totalAmount:[null]}),this.beneficiaryForm=this._formBuilder.group({idNumber:[null,[a.kI.required,a.kI.maxLength(11)]],cardNo:[null,[a.kI.required]],deposit:[null,[a.kI.required]],name:[null,[a.kI.required]],lastName1:[null,[a.kI.required]],lastName2:[null],state:[null,[a.kI.required]],city:[null,[a.kI.required]],town:[null,[a.kI.required]],address:[null,[a.kI.required]],phoneNumber:[null,[a.kI.required]],note:[null,[a.kI.required]]}),this.invoice$=this.store.select(Z),this.invoice$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(o=>{this.selectedInvoice=o,null!==o&&this.editMode&&(this.invoiceForm.patchValue(this.selectedInvoice),this.remitterForm.patchValue(this.selectedInvoice.remitter),this.beneficiaryForm.patchValue(this.selectedInvoice.beneficiary)),this._changeDetectorRef.markForCheck()}),this._activatedRoute.params.pipe((0,l.R)(this._unsubscribeAll)).subscribe(({invoiceId:o})=>{this.invoiceId=o,"new"!==o&&this.store.select(Z).pipe((0,l.R)(this._unsubscribeAll),(0,z.h)(c=>null!==c||void 0)).subscribe(c=>{this.selectedInvoice=c,this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()}),null===(t=this.beneficiaryForm.get("state"))||void 0===t||t.valueChanges.pipe((0,l.R)(this._unsubscribeAll)).subscribe(o=>{this._getCitiesByState(o),this._changeDetectorRef.markForCheck()}),this.invoiceForm.get("amount").valueChanges.pipe((0,l.R)(this._unsubscribeAll)).subscribe(o=>{const c=this.remitterForm.getRawValue();c.totalAmount&&c.totalAmount+ +o>1e4?this.invoiceForm.get("amount").setErrors({maxAmount:{value:"El remesante seleccionado supera el importe m\xe1ximo en este per\xedodo."}}):c.totalAmount&&this.invoiceForm.get("amount").hasError("maxAmount")&&this.invoiceForm.get("amount").setErrors(null)}),this.filteredRemitters=this.remitterForm.get("idNumber").valueChanges.pipe((0,l.R)(this._unsubscribeAll),(0,R.b)(600),(0,w.O)(""),(0,E.w)(o=>this.invoiceService.searchRemitterByIdNumber(o))),this.filteredBeneficiaries=this.beneficiaryForm.get("idNumber").valueChanges.pipe((0,l.R)(this._unsubscribeAll),(0,R.b)(600),(0,w.O)(""),(0,E.w)(o=>this.invoiceService.searchBeneficiaryByIdNumber(o)))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this.store.dispatch((0,g.sV)())}createInvoice(){const t=this.remitterForm.getRawValue(),o=this.beneficiaryForm.getRawValue(),c=this.invoiceForm.getRawValue(),v=Object.assign(Object.assign({},c),{remitter:t,beneficiary:o}),x={title:"Crear Factura",action:(0,g.BH)({invoice:v})};this.openDialog(x)}updateInvoice(){const t=this.remitterForm.getRawValue(),o=this.beneficiaryForm.getRawValue(),c=this.invoiceForm.getRawValue(),v=Object.assign(Object.assign({},c),{remitter:t,beneficiary:o}),x={title:"Actualizar Factura",action:(0,g.PA)({invoice:v})};this.openDialog(x)}fillRemitter(t){const o=t.option.value;o.totalAmount+this.invoiceForm.get("amount").value>1e4&&this.invoiceForm.get("amount").setErrors({maxAmount:{value:"El remesante selecionado supera el importe m\xe1ximo en este per\xedodo."}}),this.remitterForm.patchValue(o)}fillBeneficiary(t){this.beneficiaryForm.patchValue(t.option.value)}_getCitiesByState(t){t!==this.selectedState&&this._locationService.getCitiesByState(t).pipe((0,l.R)(this._unsubscribeAll)).subscribe(o=>{this.cities=o,this._changeDetectorRef.markForCheck()})}openDialog(t){this._athConfirmationService.open({title:t.title,message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,l.R)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&this.store.dispatch(t.action)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.gz),e.Y36(J.C),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(ee.a),e.Y36(p.F0),e.Y36(m.yh),e.Y36(Y.x))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ath-invoice-detail"]],decls:190,vars:93,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700","hover:underline",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl","text-mine-900"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 rounded-sm bg-primary-700 hover:shadow-lg","mat-button","",3,"ngClass","disabled","click",4,"ngIf"],["class","ml-4 rounded-sm bg-primary-700 hover:shadow-lg","mat-button","","mat-button","",3,"ngClass","disabled","click",4,"ngIf"],[1,"flex-auto","p-6","bg-mine-200","shadow","sm:p-10","rounded-t-2xl"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"w-full"],[3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[3,"formGroup","autocomplete"],[1,"grid","w-full","gap-6","p-8","mb-6","border-t-2","sm:grid-cols-4"],[1,"sm:col-span-2"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","required","",3,"type","formControlName"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,""],[1,"flex","flex-col"],[1,"mb-4","font-medium"],[3,"formControlName","color"],["placeholder","Escriba el N\xfamero de Identidad o Pasaporte","aria-label","Number","matInput","","required","",3,"type","formControlName","matAutocomplete"],["autoActiveFirstOption","",3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matInput","","required","",3,"type","formControlName","placeholder"],[1,"sm:col-span-4"],["matInput","","required","",3,"placeholder","formControlName"],[1,"grid","w-full","gap-6","p-8","mb-6","border-t-2","sm:grid-cols-2","md:grid-cols-4"],["autob","matAutocomplete"],["matInput","",3,"type","formControlName"],[3,"value"],[1,"sm:col-span-3"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"placeholder","formControlName"],[1,"ml-1","text-primary-700"],["mat-button","",1,"ml-4","rounded-sm","bg-primary-700","hover:shadow-lg",3,"ngClass","disabled","click"],[1,"text-mine-900",3,"svgIcon"],[1,"ml-2","mr-1","text-lg","text-mine-900"],["mat-button","","mat-button","",1,"ml-4","rounded-sm","bg-primary-700","hover:shadow-lg",3,"ngClass","disabled","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"a",5),e._uU(7,"Facturas"),e.qZA(),e.qZA(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.YNc(10,re,3,0,"ng-container",7),e.YNc(11,ae,3,1,"ng-container",7),e.qZA(),e.qZA(),e.TgZ(12,"div",8),e.TgZ(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",11),e.TgZ(18,"div",12),e.YNc(19,ce,2,0,"ng-container",7),e.YNc(20,le,2,1,"ng-container",7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",13),e.YNc(22,se,4,5,"button",14),e.YNc(23,me,4,5,"button",15),e.qZA(),e.qZA(),e.TgZ(24,"div",16),e.TgZ(25,"div",17),e.TgZ(26,"mat-accordion",18),e.TgZ(27,"mat-expansion-panel",19),e.TgZ(28,"mat-expansion-panel-header",20),e.TgZ(29,"mat-panel-title",21),e.TgZ(30,"div",22),e._uU(31," Informaci\xf3n General "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"form",23),e.TgZ(33,"div",24),e.TgZ(34,"div",25),e.TgZ(35,"mat-form-field",26),e.TgZ(36,"mat-label"),e._uU(37,"N\xfamero de Factura"),e.qZA(),e._UZ(38,"input",27),e.qZA(),e.qZA(),e.TgZ(39,"div",25),e.TgZ(40,"mat-form-field",26),e.TgZ(41,"mat-label"),e._uU(42,"Seleccione la cuenta "),e.qZA(),e.TgZ(43,"mat-select",28),e.YNc(44,ue,3,2,"ng-container",29),e.ALo(45,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(46,"div",30),e.TgZ(47,"mat-form-field",26),e.TgZ(48,"mat-label"),e._uU(49,"Importe (10.000 m\xe1x)"),e.qZA(),e._UZ(50,"input",27),e.YNc(51,de,2,0,"mat-error",7),e.YNc(52,pe,2,0,"mat-error",7),e.YNc(53,ge,2,0,"mat-error",7),e.YNc(54,ve,2,1,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(55,"div",30),e.TgZ(56,"mat-form-field",26),e.TgZ(57,"mat-label"),e._uU(58,"Comisi\xf3n de Fincimex"),e.qZA(),e._UZ(59,"input",27),e.qZA(),e.qZA(),e.TgZ(60,"div",25),e.TgZ(61,"div",31),e.TgZ(62,"span",32),e._uU(63,"\xbfEnviar a Fincimex?"),e.qZA(),e.TgZ(64,"mat-slide-toggle",33),e._uU(65),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(66,"mat-expansion-panel"),e.TgZ(67,"mat-expansion-panel-header",20),e.TgZ(68,"mat-panel-title",21),e.TgZ(69,"div",22),e._uU(70," Informaci\xf3n del Remesante "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(71,"form",23),e.TgZ(72,"div",24),e.TgZ(73,"div",25),e.TgZ(74,"mat-form-field",26),e.TgZ(75,"mat-label"),e._uU(76,"Buscar por N\xfamero de Identidad o Pasaporte"),e.qZA(),e._UZ(77,"input",34),e.TgZ(78,"mat-autocomplete",35,36),e.NdJ("optionSelected",function(v){return o.fillRemitter(v)}),e.YNc(80,fe,2,2,"mat-option",37),e.ALo(81,"async"),e.qZA(),e.YNc(82,Ze,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(83,"div",25),e.TgZ(84,"mat-form-field",26),e.TgZ(85,"mat-label"),e._uU(86,"Nombre"),e.qZA(),e._UZ(87,"input",38),e.YNc(88,he,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(89,"div",25),e.TgZ(90,"mat-form-field",26),e.TgZ(91,"mat-label"),e._uU(92,"Primer Apellido"),e.qZA(),e._UZ(93,"input",27),e.YNc(94,_e,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(95,"div",25),e.TgZ(96,"mat-form-field",26),e.TgZ(97,"mat-label"),e._uU(98,"Segundo Apellido"),e.qZA(),e._UZ(99,"input",27),e.qZA(),e.qZA(),e.TgZ(100,"div",39),e.TgZ(101,"mat-form-field",26),e.TgZ(102,"mat-label"),e._uU(103,"Direcci\xf3n"),e.qZA(),e._UZ(104,"textarea",40),e.YNc(105,xe,2,0,"mat-error",7),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(106,"mat-expansion-panel"),e.TgZ(107,"mat-expansion-panel-header",20),e.TgZ(108,"mat-panel-title",21),e.TgZ(109,"div",22),e._uU(110," Informaci\xf3n del Beneficiario "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(111,"form",23),e.TgZ(112,"div",41),e.TgZ(113,"div",30),e.TgZ(114,"mat-form-field",26),e.TgZ(115,"mat-label"),e._uU(116,"Buscar por N\xfamero de Identidad o Pasaporte"),e.qZA(),e._UZ(117,"input",34),e.YNc(118,Ae,2,0,"mat-error",7),e.YNc(119,Te,2,0,"mat-error",7),e.TgZ(120,"mat-autocomplete",35,42),e.NdJ("optionSelected",function(v){return o.fillBeneficiary(v)}),e.YNc(122,be,2,2,"mat-option",37),e.ALo(123,"async"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(124,"div",30),e.TgZ(125,"mat-form-field",26),e.TgZ(126,"mat-label"),e._uU(127,"Nombre"),e.qZA(),e._UZ(128,"input",38),e.YNc(129,Ie,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(130,"div",30),e.TgZ(131,"mat-form-field",26),e.TgZ(132,"mat-label"),e._uU(133,"Primer Apellido"),e.qZA(),e._UZ(134,"input",27),e.YNc(135,qe,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(136,"div",30),e.TgZ(137,"mat-form-field",26),e.TgZ(138,"mat-label"),e._uU(139,"Segundo Apellido"),e.qZA(),e._UZ(140,"input",43),e.qZA(),e.qZA(),e.TgZ(141,"div",30),e.TgZ(142,"mat-form-field",26),e.TgZ(143,"mat-label"),e._uU(144,"Depositar en"),e.qZA(),e.TgZ(145,"mat-select",28),e.TgZ(146,"mat-option",44),e._uU(147,"Tarjeta"),e.qZA(),e.TgZ(148,"mat-option",44),e._uU(149,"Cuenta"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(150,"div",45),e.TgZ(151,"mat-form-field",26),e.TgZ(152,"mat-label"),e._uU(153,"N\xfamero de cuenta o de tarjeta"),e.qZA(),e._UZ(154,"input",27),e.qZA(),e.qZA(),e.TgZ(155,"div",25),e.TgZ(156,"mat-form-field",26),e.TgZ(157,"mat-label"),e._uU(158,"Provincia"),e.qZA(),e._UZ(159,"mat-icon",46),e.TgZ(160,"mat-select",28),e.YNc(161,ye,2,2,"mat-option",37),e.qZA(),e.qZA(),e.qZA(),e.TgZ(162,"div",25),e.TgZ(163,"mat-form-field",26),e.TgZ(164,"mat-label"),e._uU(165,"Municipio"),e.qZA(),e._UZ(166,"mat-icon",46),e.TgZ(167,"mat-select",28),e.YNc(168,Fe,2,2,"mat-option",37),e.qZA(),e.qZA(),e.qZA(),e.TgZ(169,"div",39),e.TgZ(170,"mat-form-field",26),e.TgZ(171,"mat-label"),e._uU(172,"Direcci\xf3n"),e.qZA(),e._UZ(173,"textarea",40),e.YNc(174,Ce,2,0,"mat-error",7),e.qZA(),e.qZA(),e.TgZ(175,"div",25),e.TgZ(176,"mat-form-field",26),e.TgZ(177,"mat-label"),e._uU(178,"Reparto o Consejo Popular"),e.qZA(),e._UZ(179,"input",27),e.qZA(),e.qZA(),e.TgZ(180,"div",25),e.TgZ(181,"mat-form-field",26),e.TgZ(182,"mat-label"),e._uU(183,"Tel\xe9fono"),e.qZA(),e._UZ(184,"input",27),e.qZA(),e.qZA(),e.TgZ(185,"div",39),e.TgZ(186,"mat-form-field",26),e.TgZ(187,"mat-label"),e._uU(188,"Observaciones"),e.qZA(),e._UZ(189,"textarea",47),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const c=e.MAs(79),v=e.MAs(121);e.xp6(6),e.Q6J("routerLink","/invoices"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("ngIf","new"===o.invoiceId),e.xp6(1),e.Q6J("ngIf","new"!==o.invoiceId&&null!==o.selectedInvoice),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(5),e.Q6J("ngIf","new"===o.invoiceId),e.xp6(1),e.Q6J("ngIf","new"!==o.invoiceId&&null!==o.selectedInvoice),e.xp6(2),e.Q6J("ngIf","new"===o.invoiceId),e.xp6(1),e.Q6J("ngIf","new"!==o.invoiceId),e.xp6(4),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(4),e.Q6J("formGroup",o.invoiceForm)("autocomplete","off"),e.xp6(6),e.Q6J("type","text")("formControlName","invoiceNo"),e.xp6(5),e.Q6J("formControlName","accountId"),e.xp6(1),e.Q6J("ngForOf",e.lcZ(45,87,o.accounts$)),e.xp6(6),e.Q6J("type","number")("formControlName","amount"),e.xp6(1),e.Q6J("ngIf",o.invoiceForm.get("amount").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.invoiceForm.get("amount").hasError("min")),e.xp6(1),e.Q6J("ngIf",o.invoiceForm.get("amount").hasError("max")),e.xp6(1),e.Q6J("ngIf",o.invoiceForm.get("amount").hasError("maxAmount")),e.xp6(5),e.Q6J("type","number")("formControlName","fincimexTax"),e.xp6(5),e.Q6J("formControlName","sendFincimex")("color","primary"),e.xp6(1),e.hij(" ",!0===o.invoiceForm.get("sendFincimex").value?"Enviar":"No enviar"," "),e.xp6(2),e.Q6J("collapsedHeight","56px"),e.xp6(4),e.Q6J("formGroup",o.remitterForm)("autocomplete","off"),e.xp6(6),e.Q6J("type","text")("formControlName","idNumber")("matAutocomplete",c),e.xp6(3),e.Q6J("ngForOf",e.lcZ(81,89,o.filteredRemitters)),e.xp6(2),e.Q6J("ngIf",o.remitterForm.get("idNumber").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre"),e.xp6(1),e.Q6J("ngIf",o.remitterForm.get("name").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName1"),e.xp6(1),e.Q6J("ngIf",o.remitterForm.get("lastName1").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName2"),e.xp6(5),e.Q6J("placeholder","Direcci\xf3n del remesante")("formControlName","address"),e.xp6(1),e.Q6J("ngIf",o.remitterForm.get("address").hasError("required")),e.xp6(2),e.Q6J("collapsedHeight","56px"),e.xp6(4),e.Q6J("formGroup",o.beneficiaryForm)("autocomplete","off"),e.xp6(6),e.Q6J("type","text")("formControlName","idNumber")("matAutocomplete",v),e.xp6(1),e.Q6J("ngIf",o.beneficiaryForm.get("idNumber").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.beneficiaryForm.get("idNumber").hasError("maxLength")),e.xp6(3),e.Q6J("ngForOf",e.lcZ(123,91,o.filteredBeneficiaries)),e.xp6(6),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre"),e.xp6(1),e.Q6J("ngIf",o.beneficiaryForm.get("name").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName1"),e.xp6(1),e.Q6J("ngIf",o.beneficiaryForm.get("lastName1").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","lastName2"),e.xp6(5),e.Q6J("formControlName","deposit"),e.xp6(1),e.Q6J("value","Card"),e.xp6(2),e.Q6J("value","Bank account"),e.xp6(6),e.Q6J("type","text")("formControlName","cardNo"),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:map"),e.xp6(1),e.Q6J("formControlName","state"),e.xp6(1),e.Q6J("ngForOf",o.states),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:location-marker"),e.xp6(1),e.Q6J("formControlName","city"),e.xp6(1),e.Q6J("ngForOf",o.cities),e.xp6(5),e.Q6J("placeholder","Direcci\xf3n del remesante")("formControlName","address"),e.xp6(1),e.Q6J("ngIf",o.beneficiaryForm.get("address").hasError("required")),e.xp6(5),e.Q6J("type","text")("formControlName","town"),e.xp6(5),e.Q6J("type","text")("formControlName","phoneNumber"),e.xp6(5),e.Q6J("placeholder","Escriba cualquier comentario que considere oportuno")("formControlName","note")}},directives:[Q.PQ,p.yS,k.Hw,_.O5,D.lW,_.mk,I.pp,I.ib,I.yz,I.yK,a._Y,a.JL,a.sg,q.KE,q.hX,te.Nt,a.Fj,a.Q7,a.JJ,a.u,ie.gD,_.sg,oe.ey,q.TO,ne.Rr,N.ZL,N.XC,q.qo],pipes:[_.Ov],encapsulation:2,data:{animation:T.p},changeDetection:0}),i})(),B=(()=>{class i{constructor(t){this.store=t}resolve(t,o){return this.store.dispatch((0,g.sL)())}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(m.yh))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Je=(()=>{class i{constructor(t,o){this.store=t,this._invoiceService=o}resolve(t,o){const c=t.params.invoiceId;if("new"!==c)return this.store.dispatch((0,g.XD)({invoiceId:c}))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(m.yh),e.LFG(Y.x))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var S=n(5497),Qe=n(7681);const ke=[{path:"",component:H,resolve:{invoices:B,users:S.o}},{path:":invoiceId",component:Ue,resolve:{accounts:Qe.$c,invoice:Je,invoices:B,users:S.o}}];let De=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[p.Bz.forChild(ke),N.Bb,f.m]]}),i})()},9652:(b,h,n)=>{n.d(h,{kP:()=>g});let p=d=>crypto.getRandomValues(new Uint8Array(d)),g=(d,u=21)=>((d,u,s)=>{let l=(2<<Math.log(d.length-1)/Math.LN2)-1,m=-~(1.6*l*u/d.length);return(A=u)=>{let Z="";for(;;){let y=s(m),T=m;for(;T--;)if(Z+=d[y[T]&l]||"",Z.length===A)return Z}}})(d,u,p)}}]);